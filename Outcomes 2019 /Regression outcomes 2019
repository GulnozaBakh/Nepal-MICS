Weighted Frequencies #to check the difference between weighted and unweighted for comparison
stratum
      Bagmati province Rural       Gandaki province Rural       Karnali province Rural 
                    563.5017                     344.0732                     312.5547 
            Province 1 Rural             Province 2 Rural             Province 5 Rural 
                    763.0279                     601.4027                     955.3646 
Sudoorpaschim province Rural 
                    439.6831  
 # Unweighted frequencies for household 

       Bagmati province Rural       Gandaki province Rural       Karnali province Rural 
                         745                          630                          691 
            Province 1 Rural             Province 2 Rural             Province 5 Rural 
                         833                          817                          989 
Sudoorpaschim province Rural 
                         760 

######
#mean age of women without applying weights
[1] 28.77277
#mean age after applying weights
      mean     SE
WB4 29.106 0.1538
#######
#Bivariate Logistic Regression
1. Weighted Call:
svyglm(formula = UN16AA ~ stratum, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)                          -6.6020     0.7266  -9.086  < 2e-16 *** #Bagmati
stratumGandaki province Rural         1.4947     0.9117   1.640   0.1026    
stratumKarnali province Rural         4.4788     0.8348   5.365 2.14e-07 ***
stratumProvince 1 Rural               1.5600     0.8454   1.845   0.0664 .  
stratumProvince 2 Rural               1.4937     0.8759   1.705   0.0896 .  
stratumProvince 5 Rural               1.9630     0.8230   2.385   0.0180 *  
stratumSudoorpaschim province Rural   5.4450     0.7998   6.808 1.03e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 9
#############
2.Call:
svyglm(formula = UN16AA ~ windex5r, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -5.1705     0.3961 -13.052  < 2e-16 *** #fourth
windex5rMiddle    1.2447     0.5428   2.293   0.0228 *  
windex5rPoorest   3.1256     0.4922   6.351 1.30e-09 ***
windex5rRichest   0.3886     0.5605   0.693   0.4889    
windex5rSecond    2.5177     0.4742   5.309 2.79e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 7

3.Call:
svyglm(formula = UN16AA ~ HH51_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)              -3.3091     0.2235 -14.805  < 2e-16 *** #children aged below 5
HH51_grouped1             0.1086     0.2054   0.529  0.59762    
HH51_grouped2             0.7083     0.2441   2.901  0.00411 ** 
HH51_groupedmore than 3   0.5180     0.4946   1.047  0.29610    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6
4. Number of Fisher Scoring iterations: 6

> #12.  
> # Weighted logistic regression
> weighted_logit12F <- svyglm(UN16AF ~ welevel1, design = hh_design, family = quasibinomial)
> summary(weighted_logit12F)

Call:
svyglm(formula = UN16AF ~ welevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        -3.4622     0.2110 -16.408   <2e-16 ***
welevel1Higher     -0.5175     0.5113  -1.012   0.3126    
welevel1None       -0.1270     0.1723  -0.737   0.4617    
welevel1Secondary  -0.4292     0.2339  -1.835   0.0679 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6

> #13
> # Weighted logistic regression
> weighted_logit13F <- svyglm(UN16AF ~ HC15, design = hh_design, family = quasibinomial)
> summary(weighted_logit13F)

Call:
svyglm(formula = UN16AF ~ HC15, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -4.3296     0.4260  -10.16   <2e-16 ***
HC15YES       0.7530     0.3922    1.92   0.0562 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6

> #14
> # Weighted logistic regression
> weighted_logit14F <- svyglm(UN16AF ~ EthnicityGroup, design = hh_design, family = quasibinomial)
> summary(weighted_logit14F)

Call:
svyglm(formula = UN16AF ~ EthnicityGroup, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                  -2.8275     0.2292 -12.338  < 2e-16 ***
EthnicityGroupDalits                         -0.4400     0.4083  -1.078 0.282385    
EthnicityGroupJanajati                       -2.2605     0.4327  -5.224 4.23e-07 ***
EthnicityGroupMuslim                        -15.8293     0.3733 -42.400  < 2e-16 ***
EthnicityGroupNewar                         -15.8342     0.3630 -43.626  < 2e-16 ***
EthnicityGroupOther                          -2.0650     0.6492  -3.181 0.001692 ** 
EthnicityGroupTarai or Madhesi Other Castes  -1.6217     0.4570  -3.549 0.000478 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9487755)

Number of Fisher Scoring iterations: 17

> # 6th regression table
> table1F <- weighted_logit_F %>%
+   tbl_regression(label = list(stratum = "Region"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table2F <- weighted_logit2F %>%
+   tbl_regression(label = list(windex5r = "Rural Wealth Index Quintile"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table3F <- weighted_logit3F %>%
+   tbl_regression(label = list(HH51_grouped = "Number of Children Aged below five"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table4F <- weighted_logit4F %>%
+   tbl_regression(label = list(HH52_grouped = "Number of Children Aged 5-17"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table5F <- weighted_logit5F %>%
+   tbl_regression(label = list(HC1A_combined = "Religion"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table6F <- weighted_logit6F %>%
+   tbl_regression(label = list(helevel1 = "Education of Household Head"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table7F <- weighted_logit7F %>%
+   tbl_regression(label = list(HHAGEx = "Age of Household Head"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table8F <- weighted_logit8F %>%
+   tbl_regression(label = list(HHSEX = "Sex of Household Head"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table9F <- weighted_logit9F %>%
+   tbl_regression(label = list(WAGE = "Age of Women"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table10F <- weighted_logit10F %>%
+   tbl_regression(label = list(CM4_grouped = "Number of daughters living together"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table11F <- weighted_logit11F %>%
+   tbl_regression(label = list(MSTATUS_grouped = "Marital Status"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table12F <- weighted_logit12F %>%
+   tbl_regression(label = list(welevel1 = "Education of Women"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table13F <- weighted_logit13F %>%
+   tbl_regression(label = list(HC15 = "Owns Agricultural Land"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> table14F <- weighted_logit14F %>%
+   tbl_regression(label = list(EthnicityGroup = "Ethnicity"),
+                  exponentiate = TRUE,
+                  pvalue_fun = ~ style_pvalue(.x, digits = 2),
+   ) %>%
+   add_global_p() %>%
+   bold_p(t = 0.10) %>%
+   bold_labels() %>%
+   italicize_levels()
> # Stack the tables vertically
> stacked_tableF <- tbl_stack(
+   tbls = list(table1F, table2F, table3F, table4F, table5F, table6F, table7F, table8F, table9F, table10F, table11F, table12F, table13F, table14F)
+ )
> # Convert the gtsummary table to a gt table
> stacked_gtF <- as_gt(stacked_tableF)
> # Save the gt table as an image
> gtsave(stacked_gtF, "staying_away_from_school_work.png")
file:////var/folders/l1/wjxtm1y94g94hrtsqs46x1dh0000gn/T//Rtmpa8qWsp/filef692659f41f.html screenshot completed
> library(dplyr)
> library(haven)
> library(labelled)
> library(readxl)
> library(survey)
> library(readr)
> library(psych)
> library(tidyr)
> library(broom)
> library(tableone)
> library(gtsummary)
> library(gt)
> library(stargazer)
> library(webshot2) 
> library(stringr)
> setwd("/Users/nasib/Documents/my documents/Agripath RA/Gender Study/Nepal 2019")
> #open dataset
> data_wm <- read_sav("/Users/nasib/Documents/my documents/Agripath RA/Gender Study/Nepal 2019/Nepal 2019/Nepal MICS6 SPSS Datasets/wm.sav")
> data_hh <- read_sav("/Users/nasib/Documents/my documents/Agripath RA/Gender Study/Nepal 2019/Nepal 2019/Nepal MICS6 SPSS Datasets/hh.sav")
> head(data_wm)
# A tibble: 6 × 414
    HH1   HH2    LN   WM1   WM2   WM3 WMINT   WM4   WM5  WM6D WM6M        WM6Y WM8         WM9    
  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl+lbl>  <dbl> <dbl+lbl>   <dbl+l>
1     1     3     4     1     3     4   103   100   103     8 2 [JESTHA]  2076 2 [NO, FIR… 1 [YES]
2     1     5     2     1     5     2   101   100   101     8 2 [JESTHA]  2076 2 [NO, FIR… 1 [YES]
3     1     6     2     1     6     2   102   100   102     8 2 [JESTHA]  2076 2 [NO, FIR… 1 [YES]
4     1     6     3     1     6     3   103   100   103     8 2 [JESTHA]  2076 2 [NO, FIR… 1 [YES]
5     1     7     2     1     7     2   103   100   103     8 2 [JESTHA]  2076 1 [YES, IN… 1 [YES]
6     1     8     2     1     8     2   101   100   101     8 2 [JESTHA]  2076 2 [NO, FIR… 1 [YES]
# ℹ 400 more variables: WM17 <dbl+lbl>, WM7H <dbl>, WM7M <dbl+lbl>, WM10H <dbl>, WM10M <dbl+lbl>,
#   WM11 <dbl+lbl>, WM12 <dbl+lbl>, WM13 <dbl+lbl>, WM14 <dbl+lbl>, WM15 <dbl+lbl>, WMHINT <dbl>,
#   WMFIN <dbl+lbl>, WB3M <dbl+lbl>, WB3Y <dbl+lbl>, WB4 <dbl>, WB5 <dbl+lbl>, WB6B <dbl+lbl>,
#   WB7 <dbl+lbl>, WB9 <dbl+lbl>, WB10B <dbl+lbl>, WB11 <dbl+lbl>, WB12B <dbl+lbl>,
#   WB14 <dbl+lbl>, WB15 <dbl+lbl>, WB16 <dbl+lbl>, WB17A <dbl+lbl>, WB17 <dbl+lbl>,
#   WB18 <dbl+lbl>, WB19A <chr+lbl>, WB19B <chr+lbl>, WB19C <chr+lbl>, WB19D <chr+lbl>,
#   WB19X <chr+lbl>, WB19NR <chr+lbl>, MT1 <dbl+lbl>, MT2 <dbl+lbl>, MT3 <dbl+lbl>, …
# ℹ Use `colnames()` to see all variable names
> # Convert labelled vectors to character vectors
> data_hh <- labelled::to_character(data_hh)
> data_wm <- labelled::to_character(data_wm)
> # Use subset to filter only cases where the interview is completed and only rural areas
> filtered_data_wm <- subset(data_wm, WM17 == "COMPLETED" & HH6 == "RURAL")
> # Function to clean the data
> clean_data <- function(df, columns) {
+   df %>%
+     mutate(across(all_of(columns), 
+                   ~ toupper(str_trim(gsub("[^[:print:]]", "", .))))) %>%
+     mutate(across(all_of(columns), ~ na_if(., "NO RESPONSE")))
+ }
> # Specify the columns to clean
> columns_to_clean <- c("UN16AA", "UN16AB", "UN16AC", "UN16AD", "UN16AE", "UN16AF", "UN16AG", "UN16AH")
> # Clean the data
> filtered_data_wm <- clean_data(filtered_data_wm, columns_to_clean)
> # Create a logical condition to filter out rows with "NO RESPONSE" or NA
> condition <- !(
+   is.na(filtered_data_wm$UN16AA) | is.na(filtered_data_wm$UN16AB) | 
+     is.na(filtered_data_wm$UN16AC) | is.na(filtered_data_wm$UN16AD) | 
+     is.na(filtered_data_wm$UN16AE) | is.na(filtered_data_wm$UN16AF) | 
+     is.na(filtered_data_wm$UN16AG) | is.na(filtered_data_wm$UN16AH)
+ )
> # Use subset to filter the data
> updated_data <- subset(filtered_data_wm, condition)
> # Verify the filtering
> summary(updated_data)
      HH1             HH2              LN              WM1             WM2       
 Min.   :  1.0   Min.   : 1.00   Min.   : 1.000   Min.   :  1.0   Min.   : 1.00  
 1st Qu.: 97.0   1st Qu.: 6.00   1st Qu.: 2.000   1st Qu.: 97.0   1st Qu.: 6.00  
      WM3             WMINT             WM4              WM5              WM6D     
 Min.   : 1.000   Min.   : 101.0   Min.   : 100.0   Min.   : 101.0   Min.   : 1.0  
 1st Qu.: 2.000   1st Qu.: 501.0   1st Qu.: 500.0   1st Qu.: 501.0   1st Qu.: 5.0  
     WM6M                WM6Y          WM8                WM9                WM17          
 Length:5470        Min.   :2076   Length:5470        Length:5470        Length:5470       
 Class :character   1st Qu.:2076   Class :character   Class :character   Class :character  
      WM7H           WM7M               WM10H          WM10M               WM11          
 Min.   : 6.00   Length:5470        Min.   : 6.00   Length:5470        Length:5470       
 1st Qu.: 9.00   Class :character   1st Qu.:10.00   Class :character   Class :character  
     WM12               WM13               WM14               WM15               WMHINT      
 Length:5470        Length:5470        Length:5470        Length:5470        Min.   : 101.0  
 Class :character   Class :character   Class :character   Class :character   1st Qu.: 501.0  
    WMFIN               WB3M               WB3Y                WB4            WB5           
 Length:5470        Length:5470        Length:5470        Min.   :15.00   Length:5470       
 Class :character   Class :character   Class :character   1st Qu.:21.00   Class :character  
     WB6B               WB7                WB9               WB10B               WB11          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    WB12B               WB14               WB15               WB16              WB17A          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     WB17               WB18              WB19A              WB19B              WB19C          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    WB19D              WB19X              WB19NR              MT1                MT2           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MT3                MT4                MT5                MT6A               MT6B          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MT6C               MT6D               MT6E               MT6F               MT6G          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MT6H               MT6I               MT9                MT10               MT11          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MT12               MA1                MA2                MA3                MA4           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MA5                MA6                MA7                MA8M               MA8Y          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MA11               CM1                CM2                 CM3             CM4       
 Length:5470        Length:5470        Length:5470        Min.   :0.000   Min.   :0.000  
 Class :character   Class :character   Class :character   1st Qu.:1.000   1st Qu.:0.000  
     CM5                 CM6             CM7            CM8                 CM9       
 Length:5470        Min.   :0.000   Min.   :0.000   Length:5470        Min.   :0.000  
 Class :character   1st Qu.:0.000   1st Qu.:0.000   Class :character   1st Qu.:0.000  
      CM10            CM11           CM12               CM15               CM17          
 Min.   :0.000   Min.   : 0.00   Length:5470        Length:5470        Length:5470       
 1st Qu.:0.000   1st Qu.: 1.00   Class :character   Class :character   Class :character  
     BH11               DB2                DB4                MN2                MN3A          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN3B               MN3C               MN3D               MN3E               MN3H          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN3F               MN3G               MN3X              MN3NR              MN4AU          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN4AN               MN5                MN6A               MN6B               MN6C          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN7                MN8                MN9                MN11               MN12          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN14               MN16               MN17              MN18A              MN18B          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN18C              MN18X              MN18NR             MN19A              MN19B          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN19C              MN19D              MN19E              MN19I              MN19F          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN19G              MN19H              MN19X              MN19Y              MN19NR         
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN20               MN21               MN22               MN23               MN24          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN25              MN26U              MN26N               MN28               MN29          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN30              MN31A              MN31B              MN31C              MN31D          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN31E              MN31F              MN31G              MN31X              MN31Z          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN31NR              MN32               MN33              MN34A               MN34          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN35               MN36              MN37U              MN37N               MN38          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN39A              MN39B              MN39C              MN39D              MN39E          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN39F              MN39G              MN39H              MN39I              MN39J          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN39X              MN39Y              MN39NR              PN3U               PN3N          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     PN4                PN5                PN6                PN8                PN9           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     PN10               PN11               PN12              PN13U              PN13N          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN14A              PN14B              PN14C              PN14D              PN14E          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN14I              PN14F              PN14G              PN14H              PN14X          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN14NR              PN15               PN17               PN19               PN20          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     PN21              PN22U              PN22N              PN23A              PN23B          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN23C              PN23D              PN23E              PN23I              PN23F          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN23G              PN23H              PN23X              PN23NR              PN24          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN25A              PN25B              PN25C               PN27               PN29          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     PN30               CP1                CP2                CP3                CP4A          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     CP4B               CP4C               CP4D               CP4E               CP4F          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     CP4G               CP4H               CP4I               CP4J               CP4L          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     CP4M               CP4X              CP4NR               UN2                UN4           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     UN5                UN7                UN8U               UN8N               UN11          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    UN12A              UN12B              UN12C              UN12D              UN12E          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    UN12F              UN12G              UN12H              UN12I              UN12X          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    UN12Z              UN12NR             UN14U              UN14N              UN16AA         
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    UN16AB             UN16AC             UN16AD             UN16AE             UN16AF         
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    UN16AG             UN16AH              UN17               UN18               UN19          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     DV1A               DV1B               DV1C               DV1D               DV1E          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     DV2A               DV2B               DV2C               DV2D               DV2E          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     DV2F               HT1                HT2A               HT2B               HT2C          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HT2D               HT2E               HT2F               HT2G               HT2H          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HT2I               AF2                AF3                AF6                AF8           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     AF9                AF10               AF11               AF12               HA1           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA2                HA3                HA4                HA5                HA6           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA7                HA8A               HA8B               HA8C               HA10          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    HA13A              HA13B              HA13C              HA13D               HA14          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA15               HA16               HA18               HA19               HA20          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA22               HA23               HA24               HA25               HA26          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA27               HA28               HA29               HA30               HA31          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA32               HA33               HA34               HA35               HA36          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     TA1                TA2                TA3                TA4                TA5           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     TA6                TA7                TA8A               TA8B               TA8D          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     TA8X              TA8NR               TA9                TA10               TA11          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    TA12A              TA12B              TA12C              TA12X              TA12NR         
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     TA13               TA14               TA15               TA16               TA17          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     LS1                LS2                LS3                LS4                 HH4        
 Length:5470        Length:5470        Length:5470        Length:5470        Min.   : 100.0  
 Class :character   Class :character   Class :character   Class :character   1st Qu.: 500.0  
     HH6                HH7                 WDOI          WAGE                WDOB     
 Length:5470        Length:5470        Min.   :2113   Length:5470        Min.   :1515  
 Class :character   Class :character   1st Qu.:2114   Class :character   1st Qu.:1679  
      WDOM          WAGEM           WDOBFC         WDOBLC       MSTATUS               CEB        
 Min.   :1628   Min.   : 5.00   Min.   :1705   Min.   :1718   Length:5470        Min.   : 0.000  
 1st Qu.:1878   1st Qu.:16.00   1st Qu.:1899   1st Qu.:1991   Class :character   1st Qu.: 0.000  
     CSURV           CDEAD          BH3_first          BH4D_first         BH4M_first       
 Min.   : 0.00   Min.   :0.00000   Length:5470        Length:5470        Length:5470       
 1st Qu.: 0.00   1st Qu.:0.00000   Class :character   Class :character   Class :character  
  BH4Y_first         BH6_first           BH3_last          BH4D_last          BH4M_last        
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
  BH4Y_last           BH6_last           welevel1           welevel2          insurance        
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
  disability            HH7b               HH7c              WB17b              wmweight     
 Length:5470        Length:5470        Length:5470        Length:5470        Min.   :0.1188  
 Class :character   Class :character   Class :character   Class :character   1st Qu.:0.4474  
     wscore          windex5            windex10            wscoreu       windex5u        
 Min.   :-1.9615   Length:5470        Length:5470        Min.   : NA    Length:5470       
 1st Qu.:-1.0231   Class :character   Class :character   1st Qu.: NA    Class :character  
  windex10u            wscorer           windex5r          windex10r           ListCat         
 Length:5470        Min.   :-2.03922   Length:5470        Length:5470        Length:5470       
 Class :character   1st Qu.:-0.74663   Class :character   Class :character   Class :character  
      PSU          dstratum           stratum         
 Min.   :  1.0   Length:5470        Length:5470       
 1st Qu.: 97.0   Class :character   Class :character  
 [ reached getOption("max.print") -- omitted 5 rows ]
> # Define the mapping of each ethnicity to its group
> ethnicity_mapping <- list(
+   "Brahman or Chhetri" = c("Brahman - Hill", "Chhetree", "Thakuri", "Sanyasi/Dashnami", "Brahman - Tarai", "Rajput", "Kayastha"),
+   "Tarai or Madhesi Other Castes" = c("Teli", "Terai Others", "Rajbansi", "Gangai", "Yadav", "Bantaba", "Jhangad/Dhagar", "Bantar/Sardar", 
+                                       "Kewat", "Kahar", "Musahar", "Hajam/Thakur", "Koiri/Kushwaha", "Sonar", "Bangali", "Dhimal", "Danuwar", 
+                                       "Tajpuriya", "Kurmi", "Dhanuk", "Meche", "Koche", "Khawas", "Mallaha", "Kori", "Marwadi", "Kalwar", 
+                                       "Tatma/Tatwa", "Sarbaria", "Mali", "Dhobi", "Amat", "Baraee", "Dom", "Gaderi/Bhedhar", "Sudhi", "Lohar", 
+                                       "Kumhar", "Kanu", "Kathbaniyan", "Nuniya", "Dev", "Khatwe", "Kamar", "Badhaee", "Bin", "Rajbhar", 
+                                       "Lodh", "Chidimar"),
+   "Dalits" = c("Sarki", "Damai/Dholi", "Dalit Others", "Kami", "Chamar/Harijan/Ram", "Dusadh/Pasawan/Pasi", "Badi"),
+   "Newar" = c("Newar"),
+   "Janajati" = c("Gharti/Bhujel", "Limbu", "Tamang", "Gurung", "Rai", "Kulung", "Sherpa", "Magar", "Majhi", "Lepcha", "Aathpariya", 
+                  "Chamling", "Yakkha", "Hayu", "Jirel", "Chepang/Praja", "Brahmu/Baramo", "Dura", "Thakali", "Kisan", "Chhantyal/Chhantel", 
+                  "Bote", "Darai", "Byasi/Sanka", "Mewahang Bala", "Kusunda", "Raji", "Sunuwar", "Ghale", "Pahari", "Natuwa", "Thami", 
+                  "Raute", "Gurung"),
+   "Muslim" = c("Musalman"),
+   "Other" = c("Others")
+ )
> # Function to map ethnicities to groups, including handling NAs
> map_ethnicity <- function(ethnicity) {
+   if (is.na(ethnicity)) {
+     return("Missing")
+   }
+   for (group in names(ethnicity_mapping)) {
+     if (ethnicity %in% ethnicity_mapping[[group]]) {
+       return(group)
+     }
+   }
+   return("Other")  # Default to "Other" if no match is found
+ }
> # Apply the mapping to create a new variable
> data_hh <- data_hh %>%
+   mutate(EthnicityGroup = sapply(HC2, map_ethnicity))
> #Recode HHAGE into HHAGEx (4 groups)
> data_hh <- data_hh %>%
+   mutate(
+     HHAGEx = case_when(
+       HHAGE >= 15 & HHAGE <= 19 ~ 1,
+       HHAGE >= 20 & HHAGE <= 24 ~ 2,
+       HHAGE >= 25 & HHAGE <= 49 ~ 3,
+       HHAGE >= 50 ~ 4
+     )
+   )
> # Convert HHAGEx to a factor with appropriate labels
> data_hh$HHAGEx <- factor(data_hh$HHAGEx, levels = c(1, 2, 3, 4), labels = c("15-19", "20-24", "25-49", "50 plus"))
> # Check the summary to ensure the recoding worked
> summary(data_hh$HHAGEx)
  15-19   20-24   25-49 50 plus    NA's 
     76     512    6548    5519     145 
> # Convert "NO RESPONSE" to NA for the HC15 column
> data_hh <- data_hh %>%
+   mutate(HC15 = na_if(toupper(str_trim(gsub("[^[:print:]]", "", HC15))), "NO RESPONSE"))
> # Remove rows with NA values in HC15
> cleaned_data_hh <- subset(data_hh, !is.na(HC15))
> # Verify the unique values in HC15 after cleaning
> unique(cleaned_data_hh$HC15)
[1] "YES" "NO" 
> # Select relevant variables from the household dataset
> selected_data_hh <- cleaned_data_hh %>%
+   select(HH1, HH2, HH6, HH7, HH49, stratum, windex5r, HH51, HH52, HC1A, EthnicityGroup, HC15, helevel1, hhweight, HHAGEx, HHSEX, HHAGE)
> # Select relevant variables from the women's dataset
> selected_data_wm <- updated_data %>%
+   select(HH1, HH2, UN16AA, UN16AB, UN16AC, UN16AD, UN16AE, UN16AF, UN16AG, UN16AH, WAGE, WM17, CM4, MSTATUS, welevel1, wmweight, WB4)
> # Merge the datasets on HH1 and HH2
> merged_data_new <- merge(selected_data_hh, selected_data_wm, by = c("HH1", "HH2"))
> View(merged_data_new)
> #Table for the number of women following practices in different regions
> xtabs(~UN16AA + HH7, data=merged_data_new)
      HH7
UN16AA GANDAKI PROVINCE KARNALI PROVINCE PROVINCE NO. 1 PROVINCE NO. 2 PROVINCE NO. 3
   NO               625              617            826            812            743
   YES                5               74              7              5              2
      HH7
UN16AA PROVINCE NO. 5 SUDOORPASCHIM PROVINCE
   NO             980                    578
   YES              9                    182
> # Combine low count categories for demonstration
> merged_data_new$HC1A_combined <- with(merged_data_new, ifelse(HC1A %in% c("JAIN", "NO RELIGION", "OTHERS", "PRAKRITI", "BON", "KIRAT"), "OTHER", HC1A))
> # Create a new grouped variable for CM4
> merged_data_new$CM4_grouped <- ifelse(merged_data_new$CM4 >= 3, "More than 2", as.character(merged_data_new$CM4))
> # Convert the new variable to a factor
> merged_data_new$CM4_grouped <- factor(merged_data_new$CM4_grouped, levels = c("0", "1", "2", "More than 2"))
> #Group MSTATUS into two groups
> merged_data_new$MSTATUS_grouped <- ifelse(merged_data_new$MSTATUS %in% c("Currently married/in union", "Formerly married/in union"), "Ever Married", "Never Married")
> # Convert the new variable to a factor
> merged_data_new$MSTATUS_grouped <- factor(merged_data_new$MSTATUS_grouped, levels = c("Ever Married", "Never Married"))
> # Create a new variable HH51_grouped in the dataset
> merged_data_new$HH51_grouped <- ifelse(merged_data_new$HH51 > 2, "more than 3", as.character(merged_data_new$HH51))
> # Convert to a factor with meaningful levels
> merged_data_new$HH51_grouped <- factor(merged_data_new$HH51_grouped, levels = c("0", "1", "2", "more than 3"))
> # Check the distribution of the new variable
> table(merged_data_new$HH51_grouped)

          0           1           2 more than 3 
       2761        1940         619         145 
> # Create a new variable HH51_grouped in the dataset
> merged_data_new$HH52_grouped <- ifelse(merged_data_new$HH52 > 3, "more than 4", as.character(merged_data_new$HH52))
> # Convert to a factor with meaningful levels
> merged_data_new$HH52_grouped <- factor(merged_data_new$HH52_grouped, levels = c("0", "1", "2", "3", "more than 4"))
> # Check the distribution of the new variable
> table(merged_data_new$HH52_grouped)

          0           1           2           3 more than 4 
       1429        1530        1250         781         475 
> # Convert character variables to factors
> merged_data_new <- merged_data_new %>%
+   mutate(
+     HH6 = as.factor(HH6),
+     HH7 = as.factor(HH7),
+     stratum = as.factor(stratum),
+     windex5r = as.factor(windex5r),
+     HC1A = as.factor(HC1A),
+     EthnicityGroup = as.factor(EthnicityGroup),
+     HC15 = as.factor(HC15),
+     helevel1 = as.factor(helevel1),
+     HHSEX = as.factor(HHSEX),
+     UN16AA = as.factor(UN16AA),
+     UN16AB = as.factor(UN16AB),
+     UN16AC = as.factor(UN16AC),
+     UN16AD = as.factor(UN16AD),
+     UN16AE = as.factor(UN16AE),
+     UN16AF = as.factor(UN16AF),
+     UN16AG = as.factor(UN16AG),
+     UN16AH = as.factor(UN16AH),
+     WAGE = as.factor(WAGE),
+     WM17 = as.factor(WM17),
+     welevel1 = as.factor(welevel1),
+     HC1A_combined = as.factor(HC1A_combined)
+   )
> # Verify the conversion
> str(merged_data_new)
'data.frame':	5465 obs. of  37 variables:
 $ HH1            : num  1 1 1 1 1 1 1 1 1 1 ...
 $ HH2            : num  11 12 14 14 16 16 17 18 19 20 ...
 $ HH6            : Factor w/ 1 level "RURAL": 1 1 1 1 1 1 1 1 1 1 ...
 $ HH7            : Factor w/ 7 levels "GANDAKI PROVINCE",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ HH49           : num  1 1 2 2 2 2 1 1 1 1 ...
 $ stratum        : Factor w/ 7 levels "Bagmati province Rural",..: 4 4 4 4 4 4 4 4 4 4 ...
 $ windex5r       : Factor w/ 5 levels "Fourth","Middle",..: 5 5 3 3 3 3 3 5 3 5 ...
 $ HH51           : num  1 2 0 0 1 1 0 0 0 0 ...
 $ HH52           : num  0 4 4 4 1 1 0 1 0 0 ...
 $ HC1A           : Factor w/ 10 levels "BON","BUDDHIST",..: 7 7 4 4 4 4 4 4 7 4 ...
 $ EthnicityGroup : Factor w/ 7 levels "Brahman or Chhetri",..: 3 3 1 1 3 3 2 2 3 3 ...
 $ HC15           : Factor w/ 2 levels "NO","YES": 2 2 2 2 2 2 2 2 2 1 ...
 $ helevel1       : Factor w/ 4 levels "Basic (Gr 1-8)",..: 4 1 4 4 4 4 3 3 1 3 ...
 $ hhweight       : num  0.503 0.503 1.318 1.318 1.318 ...
 $ HHAGEx         : Factor w/ 4 levels "15-19","20-24",..: 4 3 3 3 4 4 3 4 3 4 ...
 $ HHSEX          : Factor w/ 2 levels "Female","Male": 2 2 2 2 2 2 2 2 2 2 ...
 $ HHAGE          : num  73 37 38 38 56 56 48 86 30 78 ...
 $ UN16AA         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AB         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AC         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AD         : Factor w/ 2 levels "NO","YES": 1 1 2 2 1 1 1 1 1 1 ...
 $ UN16AE         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AF         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AG         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AH         : Factor w/ 2 levels "NO","YES": 1 2 2 2 2 2 2 2 2 2 ...
 $ WAGE           : Factor w/ 7 levels "15-19","20-24",..: 4 5 5 1 2 4 7 5 2 2 ...
 $ WM17           : Factor w/ 1 level "COMPLETED": 1 1 1 1 1 1 1 1 1 1 ...
 $ CM4            : num  0 2 3 NA 1 NA NA 1 NA NA ...
 $ MSTATUS        : chr  "Currently married/in union" "Currently married/in union" "Currently married/in union" "Never married/in union" ...
 $ welevel1       : Factor w/ 4 levels "Basic (Gr 1-8)",..: 4 3 4 4 4 4 3 2 1 4 ...
 $ wmweight       : num  0.509 0.509 1.333 1.333 1.333 ...
 $ WB4            : num  31 37 38 16 24 30 45 37 23 20 ...
 $ HC1A_combined  : Factor w/ 5 levels "BUDDHIST","CHRISTIAN",..: 5 5 3 3 3 3 3 3 5 3 ...
 $ CM4_grouped    : Factor w/ 4 levels "0","1","2","More than 2": 1 3 4 NA 2 NA NA 2 NA NA ...
 $ MSTATUS_grouped: Factor w/ 2 levels "Ever Married",..: 1 1 1 2 1 1 1 1 1 2 ...
 $ HH51_grouped   : Factor w/ 4 levels "0","1","2","more than 3": 2 3 1 1 2 2 1 1 1 1 ...
 $ HH52_grouped   : Factor w/ 5 levels "0","1","2","3",..: 1 5 5 5 2 2 1 2 1 1 ...
> #If you want to save the document, run the following by choosing the directory
> write.csv(merged_data_new, file = "/Users/nasib/Desktop/Nepal MICS/merged_data_with_NAs_2019.csv")
> ####################################Creating a frequency distribution (summary) table on unweighted data
> # Select the desired variables including the new summary index
> d <- merged_data_new %>% 
+   select(stratum, windex5r, HH51_grouped, HH52_grouped, EthnicityGroup, HC1A_combined, HC15, helevel1, HHAGEx, HHSEX, WAGE, welevel1, MSTATUS_grouped, UN16AA, UN16AB, UN16AC, UN16AD, UN16AE, UN16AF, UN16AG, UN16AH)
> # Example variable labels
> variable_labels <- list(
+   stratum = "Region",
+   windex5r = "Rural Wealth Index Quintile",
+   HH51_grouped = "Number of Children Under Age 5",
+   HH52_grouped = "Number of Children Age 5-17",
+   EthnicityGroup = "Ethnicity of Household Head",
+   MSTATUS_grouped = "Marital Status",
+   HC1A_combined = "Religion of Household Head",
+   HC15 = "Owns Agricultural Land",
+   helevel1 = "Education Level of Household Head",
+   HHAGEx = "Age of Household Head",
+   HHSEX = "Sex of Household Head",
+   WAGE = "Age Range of Women",
+   welevel1 = "Education of Women",
+   UN16AA = "Staying in a chaupadi/chhapro",
+   UN16AB = "Staying in a separate room ",
+   UN16AC = "Staying in the cowshed",
+   UN16AD = "Eating in a separate place",
+   UN16AE = "Bathing in a separate place",
+   UN16AF = "Staying away from school or work",
+   UN16AG = "Staying away from social gatherings",
+   UN16AH = "Staying away from religious work "
+ )
> # Create the summary table with custom labels
> summary_table <- tbl_summary(
+   d,
+   label = variable_labels
+ )
> # Display the summary table
> summary_table
> #Save it 
> summary_gt <- as_gt(summary_table)
> gtsave(summary_gt, filename = "summary_table1.png")
file:////var/folders/l1/wjxtm1y94g94hrtsqs46x1dh0000gn/T//Rtmpa8qWsp/filef6926ba8f0a.html screenshot completed
> ##########################################
> #convert Yes and NO to 1 and 0 in the practices columns
> merged_data_new <- merged_data_new %>%
+   mutate(across(c(UN16AA, UN16AB, UN16AC, UN16AD, UN16AE, UN16AF, UN16AG, UN16AH), ~ ifelse(. == "YES", 1, ifelse(. == "NO", 0, NA))))
> # Renaming levels of the factor
> # Step 1: Trim whitespace from the levels
> merged_data_new$helevel1 <- trimws(merged_data_new$helevel1)
> merged_data_new$welevel1 <- trimws(merged_data_new$welevel1)
> # Step 2: Convert factor levels with the cleaned data
> merged_data_new$helevel1 <- factor(merged_data_new$helevel1, 
+                                    levels = c("Basic (Gr 1-8)", "Higher", "None", "Secondary (Gr 9-12)") ,
+                                    labels = c("Basic", "Higher", "None", "Secondary"))
> merged_data_new$welevel1 <- factor(merged_data_new$welevel1, 
+                                    levels = c("Basic (Gr 1-8)", "Higher", "None", "Secondary (Gr 9-12)") ,
+                                    labels = c("Basic", "Higher", "None", "Secondary"))
> merged_data_new$HHAGEx <- factor(merged_data_new$HHAGEx, 
+                                    levels = c("15-19", "20-24","25-49", "50 plus" ),
+                                    labels = c("15 to 19", "20 to 24","25 to 49", "50 plus"   ))
> merged_data_new$WAGE <- factor(merged_data_new$WAGE, 
+                                  levels = c("15-19", "20-24", "25-29", "30-34", "35-39",  "40-44", "45-49" ),
+                                  labels = c("15 to 19", "20 to 24", "25 to 29","30 to 34", "35 to 39", "40 to 44",  "45 to 49" ))
> # Create survey design objects for each level
> hh_design <- svydesign(id = ~HH1, weights = ~hhweight,strata = ~stratum, data = merged_data_new)
> wm_design <- svydesign(id = ~HH1, weights = ~wmweight,strata = ~stratum, data = merged_data_new)
> summary(hh_design)
Stratified 1 - level Cluster Sampling design (with replacement)
With (222) clusters.
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)
Probabilities:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.4934  1.0633  1.5139  1.8031  2.2685  8.5346 
Stratum Sizes: 
           Bagmati province Rural Gandaki province Rural Karnali province Rural Province 1 Rural
obs                           745                    630                    691              833
design.PSU                     33                     30                     28               36
actual.PSU                     33                     30                     28               36
           Province 2 Rural Province 5 Rural Sudoorpaschim province Rural
obs                     817              989                          760
design.PSU               31               36                           28
actual.PSU               31               36                           28
Data variables:
 [1] "HH1"             "HH2"             "HH6"             "HH7"             "HH49"           
 [6] "stratum"         "windex5r"        "HH51"            "HH52"            "HC1A"           
[11] "EthnicityGroup"  "HC15"            "helevel1"        "hhweight"        "HHAGEx"         
[16] "HHSEX"           "HHAGE"           "UN16AA"          "UN16AB"          "UN16AC"         
[21] "UN16AD"          "UN16AE"          "UN16AF"          "UN16AG"          "UN16AH"         
[26] "WAGE"            "WM17"            "CM4"             "MSTATUS"         "welevel1"       
[31] "wmweight"        "WB4"             "HC1A_combined"   "CM4_grouped"     "MSTATUS_grouped"
[36] "HH51_grouped"    "HH52_grouped"   
> svymean(~WB4, hh_design) #mean age of women just to check the difference
      mean     SE
WB4 29.109 0.1547
> svymean(~WB4, wm_design)
     mean     SE
WB4 29.11 0.1548
> mean(merged_data_new$WB4) #mean age without applying weights
[1] 28.77237
> # Unweighted frequencies for household 
> if (nrow(merged_data_new) > 0) { 
+   cat('!!! UNWEIGHTED FREQUENCIES FOR HOUSEHOLD !!!\n')
+   unweighted_freq <- lapply(merged_data_new[c("stratum")], table)
+   print(unweighted_freq)
+ } else {
+   cat('No rows match the filtering criteria.\n')
+ }
!!! UNWEIGHTED FREQUENCIES FOR HOUSEHOLD !!!
$stratum

      Bagmati province Rural       Gandaki province Rural       Karnali province Rural 
                         745                          630                          691 
            Province 1 Rural             Province 2 Rural             Province 5 Rural 
                         833                          817                          989 
Sudoorpaschim province Rural 
                         760 

> # Weighted frequencies for household
> cat('!!! WEIGHTED FREQUENCIES FOR HOUSEHOLD !!!\n')
!!! WEIGHTED FREQUENCIES FOR HOUSEHOLD !!!
> weighted_freq <- svytable(~stratum, hh_design)
> print(weighted_freq)
stratum
      Bagmati province Rural       Gandaki province Rural       Karnali province Rural 
                    563.5017                     344.0732                     312.5547 
            Province 1 Rural             Province 2 Rural             Province 5 Rural 
                    763.0279                     601.4027                     955.3646 
Sudoorpaschim province Rural 
                    439.6831 
> ############################## Change the Variable names (labels) names
> attr(merged_data_new[["stratum"]], "label") <- "Region"
> attr(merged_data_new[["windex5r"]], "label") <- "Rural Wealth Index Quintile"
> attr(merged_data_new[["HH51_grouped"]], "label") <- "Number of Chilren Aged below 5"
> attr(merged_data_new[["HH52_grouped"]], "label") <- "Number of Chilren Aged 5-17"
> attr(merged_data_new[["HC1A_combined"]], "label") <- "Religion"
> attr(merged_data_new[["EthnicityGroup"]], "label") <- "Ethnicity"
> attr(merged_data_new[["HC15"]], "label") <- "Owns Agricultural Land"
> attr(merged_data_new[["helevel1"]], "label") <- "Education of Household Head"
> attr(merged_data_new[["HHAGEx"]], "label") <- "Age of Household Head"
> attr(merged_data_new[["HHSEX"]], "label") <- "Sex of Household Head"
> attr(merged_data_new[["UN16AA"]], "label") <- "Staying in a chaupadi/chhapro"
> attr(merged_data_new[["UN16AB"]], "label") <- "Staying in a separate room "
> attr(merged_data_new[["UN16AC"]], "label") <- "Staying in the cowshed"
> attr(merged_data_new[["UN16AD"]], "label") <- "Eating in a separate place"
> attr(merged_data_new[["UN16AE"]], "label") <- "Bathing in a separate place"
> attr(merged_data_new[["UN16AF"]], "label") <- "Staying away from school or work"
> attr(merged_data_new[["UN16AG"]], "label") <- "Staying away from social gatherings"
> attr(merged_data_new[["UN16AH"]], "label") <- "Staying away from religious work "
> attr(merged_data_new[["WAGE"]], "label") <- "Age of Women "
> attr(merged_data_new[["CM4"]], "label") <- "Number of daughters living together "
> attr(merged_data_new[["MSTATUS_grouped"]], "label") <- "Marital Status "
> attr(merged_data_new[["welevel1"]], "label") <- "Education of women"
> #1.Unweighted logistic regression
> unweighted_logit <- glm(UN16AA ~ stratum, data = merged_data_new, family = binomial)
> summary(unweighted_logit)

Call:
glm(formula = UN16AA ~ stratum, family = binomial, data = merged_data_new)

Coefficients:
                                    Estimate Std. Error z value Pr(>|z|)    
(Intercept)                          -5.9175     0.7080  -8.358  < 2e-16 ***
stratumGandaki province Rural         1.0892     0.8384   1.299    0.194    
stratumKarnali province Rural         3.7967     0.7186   5.284 1.27e-07 ***
stratumProvince 1 Rural               1.1469     0.8033   1.428    0.153    
stratumProvince 2 Rural               0.8275     0.8381   0.987    0.324    
stratumProvince 5 Rural               1.2272     0.7832   1.567    0.117    
stratumSudoorpaschim province Rural   4.7620     0.7131   6.678 2.42e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2232.6  on 5464  degrees of freedom
Residual deviance: 1637.4  on 5458  degrees of freedom
AIC: 1651.4

Number of Fisher Scoring iterations: 8

> # Weighted logistic regression
> weighted_logit <- svyglm(UN16AA ~ stratum, design = hh_design, family = quasibinomial)
> summary(weighted_logit)

Call:
svyglm(formula = UN16AA ~ stratum, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)                          -6.6020     0.7266  -9.086  < 2e-16 ***
stratumGandaki province Rural         1.4947     0.9117   1.640   0.1026    
stratumKarnali province Rural         4.4788     0.8348   5.365 2.14e-07 ***
stratumProvince 1 Rural               1.5600     0.8454   1.845   0.0664 .  
stratumProvince 2 Rural               1.4937     0.8759   1.705   0.0896 .  
stratumProvince 5 Rural               1.9630     0.8230   2.385   0.0180 *  
stratumSudoorpaschim province Rural   5.4450     0.7998   6.808 1.03e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 9

> #to check the frequency 
> xtabs(~UN16AA + stratum, data=merged_data_new) #for unweighted
      stratum
UN16AA Bagmati province Rural Gandaki province Rural Karnali province Rural Province 1 Rural
     0                    743                    625                    617              826
     1                      2                      5                     74                7
      stratum
UN16AA Province 2 Rural Province 5 Rural Sudoorpaschim province Rural
     0              812              980                          578
     1                5                9                          182
> svytable(~UN16AA + stratum, hh_design) #for weighted
      stratum
UN16AA Bagmati province Rural Gandaki province Rural Karnali province Rural Province 1 Rural
     0            562.7376731            342.0032093            279.1562021      758.1296442
     1              0.7639866              2.0699823             33.3984878        4.8982521
      stratum
UN16AA Province 2 Rural Province 5 Rural Sudoorpaschim province Rural
     0      597.7883594      946.2173905                  334.5060946
     1        3.6143706        9.1471856                  105.1769817
> #2. 
> # Weighted logistic regression
> weighted_logit2 <- svyglm(UN16AA ~ windex5r, design = hh_design, family = quasibinomial)
> summary(weighted_logit2)

Call:
svyglm(formula = UN16AA ~ windex5r, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -5.1705     0.3961 -13.052  < 2e-16 ***
windex5rMiddle    1.2447     0.5428   2.293   0.0228 *  
windex5rPoorest   3.1256     0.4922   6.351 1.30e-09 ***
windex5rRichest   0.3886     0.5605   0.693   0.4889    
windex5rSecond    2.5177     0.4742   5.309 2.79e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 7

> #3. 
> # Weighted logistic regression
> weighted_logit3 <- svyglm(UN16AA ~ HH51_grouped, design = hh_design, family = quasibinomial)
> summary(weighted_logit3)

Call:
svyglm(formula = UN16AA ~ HH51_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)              -3.3091     0.2235 -14.805  < 2e-16 ***
HH51_grouped1             0.1086     0.2054   0.529  0.59762    
HH51_grouped2             0.7083     0.2441   2.901  0.00411 ** 
HH51_groupedmore than 3   0.5180     0.4946   1.047  0.29610    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6

> #4 
> # Weighted logistic regression
> weighted_logit4 <- svyglm(UN16AA ~ HH52_grouped, design = hh_design, family = quasibinomial)
> summary(weighted_logit4)

Call:
svyglm(formula = UN16AA ~ HH52_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -3.495851   0.250728 -13.943   <2e-16 *** #children aged 5-17
HH52_grouped1            0.003718   0.217625   0.017   0.9864    
HH52_grouped2            0.507496   0.230898   2.198   0.0290 *  
HH52_grouped3            0.565457   0.247375   2.286   0.0233 *  
HH52_groupedmore than 4  0.818614   0.336131   2.435   0.0157 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6
5. Call:
svyglm(formula = UN16AA ~ HC1A_combined, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -5.12737    0.60979  -8.408  6.2e-15 *** #buddhist
HC1A_combinedCHRISTIAN -12.50491    0.67221 -18.603  < 2e-16 ***
HC1A_combinedHINDU       2.09981    0.64011   3.280  0.00121 ** 
HC1A_combinedISLAM       0.08391    1.21061   0.069  0.94481    
HC1A_combinedOTHER       1.58200    0.92282   1.714  0.08794 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9791836)

Number of Fisher Scoring iterations: 16

6. Call:
svyglm(formula = UN16AA ~ helevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        -3.3442     0.2336 -14.318   <2e-16 *** #basic
helevel1Higher    -14.2342     0.2549 -55.846   <2e-16 ***
helevel1None        0.3308     0.2069   1.598    0.111    
helevel1Secondary   0.1917     0.2263   0.847    0.398    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9776964)

Number of Fisher Scoring iterations: 16
7. Call:
svyglm(formula = UN16AA ~ HHAGEx, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     -0.8502     0.6208  -1.369  0.17231    #15-19
HHAGEx20 to 24  -1.6890     0.5948  -2.840  0.00496 ** 
HHAGEx25 to 49  -2.3069     0.5728  -4.027 7.86e-05 ***
HHAGEx50 plus   -2.4906     0.6131  -4.062 6.84e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6
8. Call:
svyglm(formula = UN16AA ~ HHSEX, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -2.9487     0.2147  -13.74   <2e-16 ***
HHSEXMale    -0.3168     0.2216   -1.43    0.154    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6
9.Call:
svyglm(formula = UN16AA ~ WAGE, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -3.22522    0.22602 -14.270   <2e-16 ***
WAGE20 to 24  0.06814    0.16358   0.417    0.677    
WAGE25 to 29 -0.08365    0.20732  -0.404    0.687    
WAGE30 to 34  0.26211    0.22989   1.140    0.256    
WAGE35 to 39  0.10958    0.22810   0.480    0.631    
WAGE40 to 44 -0.05972    0.18617  -0.321    0.749    
WAGE45 to 49 -0.05766    0.27555  -0.209    0.834    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6
10. Call:
svyglm(formula = UN16AA ~ CM4_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -3.2696     0.2187 -14.954   <2e-16 *** #number of daughters living together
CM4_grouped1             0.1519     0.1714   0.886   0.3766    
CM4_grouped2             0.3232     0.2097   1.541   0.1248    
CM4_groupedMore than 2   0.7596     0.3010   2.524   0.0124 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9497072)

Number of Fisher Scoring iterations: 6
11. Call:
svyglm(formula = UN16AA ~ MSTATUS_grouped, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                             Estimate Std. Error t value Pr(>|t|)    
(Intercept)                   -3.1266     0.1868 -16.738   <2e-16 ***
MSTATUS_groupedNever Married  -0.2582     0.1552  -1.664   0.0976 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6
12. Call:
svyglm(formula = UN16AA ~ welevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        -3.2463     0.2097 -15.482   <2e-16 ***
welevel1Higher     -1.5230     0.7589  -2.007   0.0460 *  
welevel1None        0.3932     0.1635   2.404   0.0171 *  
welevel1Secondary  -0.2100     0.2056  -1.021   0.3083    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 7
13. > library(gtsummary)
> library(gt)
> library(stargazer)
> library(webshot2) 
> library(stringr)
> setwd("/Users/nasib/Documents/my documents/Agripath RA/Gender Study/Nepal 2019")
> #open dataset
> data_wm <- read_sav("/Users/nasib/Documents/my documents/Agripath RA/Gender Study/Nepal 2019/Nepal 2019/Nepal MICS6 SPSS Datasets/wm.sav")
> data_hh <- read_sav("/Users/nasib/Documents/my documents/Agripath RA/Gender Study/Nepal 2019/Nepal 2019/Nepal MICS6 SPSS Datasets/hh.sav")
> head(data_wm)
# A tibble: 6 × 414
    HH1   HH2    LN   WM1   WM2   WM3 WMINT   WM4   WM5  WM6D WM6M        WM6Y WM8         WM9    
  <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl+lbl>  <dbl> <dbl+lbl>   <dbl+l>
1     1     3     4     1     3     4   103   100   103     8 2 [JESTHA]  2076 2 [NO, FIR… 1 [YES]
2     1     5     2     1     5     2   101   100   101     8 2 [JESTHA]  2076 2 [NO, FIR… 1 [YES]
3     1     6     2     1     6     2   102   100   102     8 2 [JESTHA]  2076 2 [NO, FIR… 1 [YES]
4     1     6     3     1     6     3   103   100   103     8 2 [JESTHA]  2076 2 [NO, FIR… 1 [YES]
5     1     7     2     1     7     2   103   100   103     8 2 [JESTHA]  2076 1 [YES, IN… 1 [YES]
6     1     8     2     1     8     2   101   100   101     8 2 [JESTHA]  2076 2 [NO, FIR… 1 [YES]
# ℹ 400 more variables: WM17 <dbl+lbl>, WM7H <dbl>, WM7M <dbl+lbl>, WM10H <dbl>, WM10M <dbl+lbl>,
#   WM11 <dbl+lbl>, WM12 <dbl+lbl>, WM13 <dbl+lbl>, WM14 <dbl+lbl>, WM15 <dbl+lbl>, WMHINT <dbl>,
#   WMFIN <dbl+lbl>, WB3M <dbl+lbl>, WB3Y <dbl+lbl>, WB4 <dbl>, WB5 <dbl+lbl>, WB6B <dbl+lbl>,
#   WB7 <dbl+lbl>, WB9 <dbl+lbl>, WB10B <dbl+lbl>, WB11 <dbl+lbl>, WB12B <dbl+lbl>,
#   WB14 <dbl+lbl>, WB15 <dbl+lbl>, WB16 <dbl+lbl>, WB17A <dbl+lbl>, WB17 <dbl+lbl>,
#   WB18 <dbl+lbl>, WB19A <chr+lbl>, WB19B <chr+lbl>, WB19C <chr+lbl>, WB19D <chr+lbl>,
#   WB19X <chr+lbl>, WB19NR <chr+lbl>, MT1 <dbl+lbl>, MT2 <dbl+lbl>, MT3 <dbl+lbl>, …
# ℹ Use `colnames()` to see all variable names
> # Convert labelled vectors to character vectors
> data_hh <- labelled::to_character(data_hh)
> data_wm <- labelled::to_character(data_wm)
> # Use subset to filter only cases where the interview is completed and only rural areas
> filtered_data_wm <- subset(data_wm, WM17 == "COMPLETED" & HH6 == "RURAL")
> # Function to clean the data
> clean_data <- function(df, columns) {
+   df %>%
+     mutate(across(all_of(columns), 
+                   ~ toupper(str_trim(gsub("[^[:print:]]", "", .))))) %>%
+     mutate(across(all_of(columns), ~ na_if(., "NO RESPONSE")))
+ }
> # Specify the columns to clean
> columns_to_clean <- c("UN16AA", "UN16AB", "UN16AC", "UN16AD", "UN16AE", "UN16AF", "UN16AG", "UN16AH")
> # Clean the data
> filtered_data_wm <- clean_data(filtered_data_wm, columns_to_clean)
> # Create a logical condition to filter out rows with "NO RESPONSE" or NA
> condition <- !(
+   is.na(filtered_data_wm$UN16AA) | is.na(filtered_data_wm$UN16AB) | 
+     is.na(filtered_data_wm$UN16AC) | is.na(filtered_data_wm$UN16AD) | 
+     is.na(filtered_data_wm$UN16AE) | is.na(filtered_data_wm$UN16AF) | 
+     is.na(filtered_data_wm$UN16AG) | is.na(filtered_data_wm$UN16AH)
+ )
> # Use subset to filter the data
> updated_data <- subset(filtered_data_wm, condition)
> # Verify the filtering
> summary(updated_data)
      HH1             HH2              LN              WM1             WM2       
 Min.   :  1.0   Min.   : 1.00   Min.   : 1.000   Min.   :  1.0   Min.   : 1.00  
 1st Qu.: 97.0   1st Qu.: 6.00   1st Qu.: 2.000   1st Qu.: 97.0   1st Qu.: 6.00  
      WM3             WMINT             WM4              WM5              WM6D     
 Min.   : 1.000   Min.   : 101.0   Min.   : 100.0   Min.   : 101.0   Min.   : 1.0  
 1st Qu.: 2.000   1st Qu.: 501.0   1st Qu.: 500.0   1st Qu.: 501.0   1st Qu.: 5.0  
     WM6M                WM6Y          WM8                WM9                WM17          
 Length:5470        Min.   :2076   Length:5470        Length:5470        Length:5470       
 Class :character   1st Qu.:2076   Class :character   Class :character   Class :character  
      WM7H           WM7M               WM10H          WM10M               WM11          
 Min.   : 6.00   Length:5470        Min.   : 6.00   Length:5470        Length:5470       
 1st Qu.: 9.00   Class :character   1st Qu.:10.00   Class :character   Class :character  
     WM12               WM13               WM14               WM15               WMHINT      
 Length:5470        Length:5470        Length:5470        Length:5470        Min.   : 101.0  
 Class :character   Class :character   Class :character   Class :character   1st Qu.: 501.0  
    WMFIN               WB3M               WB3Y                WB4            WB5           
 Length:5470        Length:5470        Length:5470        Min.   :15.00   Length:5470       
 Class :character   Class :character   Class :character   1st Qu.:21.00   Class :character  
     WB6B               WB7                WB9               WB10B               WB11          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    WB12B               WB14               WB15               WB16              WB17A          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     WB17               WB18              WB19A              WB19B              WB19C          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    WB19D              WB19X              WB19NR              MT1                MT2           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MT3                MT4                MT5                MT6A               MT6B          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MT6C               MT6D               MT6E               MT6F               MT6G          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MT6H               MT6I               MT9                MT10               MT11          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MT12               MA1                MA2                MA3                MA4           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MA5                MA6                MA7                MA8M               MA8Y          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MA11               CM1                CM2                 CM3             CM4       
 Length:5470        Length:5470        Length:5470        Min.   :0.000   Min.   :0.000  
 Class :character   Class :character   Class :character   1st Qu.:1.000   1st Qu.:0.000  
     CM5                 CM6             CM7            CM8                 CM9       
 Length:5470        Min.   :0.000   Min.   :0.000   Length:5470        Min.   :0.000  
 Class :character   1st Qu.:0.000   1st Qu.:0.000   Class :character   1st Qu.:0.000  
      CM10            CM11           CM12               CM15               CM17          
 Min.   :0.000   Min.   : 0.00   Length:5470        Length:5470        Length:5470       
 1st Qu.:0.000   1st Qu.: 1.00   Class :character   Class :character   Class :character  
     BH11               DB2                DB4                MN2                MN3A          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN3B               MN3C               MN3D               MN3E               MN3H          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN3F               MN3G               MN3X              MN3NR              MN4AU          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN4AN               MN5                MN6A               MN6B               MN6C          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN7                MN8                MN9                MN11               MN12          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN14               MN16               MN17              MN18A              MN18B          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN18C              MN18X              MN18NR             MN19A              MN19B          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN19C              MN19D              MN19E              MN19I              MN19F          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN19G              MN19H              MN19X              MN19Y              MN19NR         
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN20               MN21               MN22               MN23               MN24          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN25              MN26U              MN26N               MN28               MN29          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN30              MN31A              MN31B              MN31C              MN31D          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN31E              MN31F              MN31G              MN31X              MN31Z          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN31NR              MN32               MN33              MN34A               MN34          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     MN35               MN36              MN37U              MN37N               MN38          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN39A              MN39B              MN39C              MN39D              MN39E          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN39F              MN39G              MN39H              MN39I              MN39J          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    MN39X              MN39Y              MN39NR              PN3U               PN3N          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     PN4                PN5                PN6                PN8                PN9           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     PN10               PN11               PN12              PN13U              PN13N          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN14A              PN14B              PN14C              PN14D              PN14E          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN14I              PN14F              PN14G              PN14H              PN14X          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN14NR              PN15               PN17               PN19               PN20          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     PN21              PN22U              PN22N              PN23A              PN23B          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN23C              PN23D              PN23E              PN23I              PN23F          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN23G              PN23H              PN23X              PN23NR              PN24          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    PN25A              PN25B              PN25C               PN27               PN29          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     PN30               CP1                CP2                CP3                CP4A          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     CP4B               CP4C               CP4D               CP4E               CP4F          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     CP4G               CP4H               CP4I               CP4J               CP4L          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     CP4M               CP4X              CP4NR               UN2                UN4           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     UN5                UN7                UN8U               UN8N               UN11          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    UN12A              UN12B              UN12C              UN12D              UN12E          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    UN12F              UN12G              UN12H              UN12I              UN12X          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    UN12Z              UN12NR             UN14U              UN14N              UN16AA         
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    UN16AB             UN16AC             UN16AD             UN16AE             UN16AF         
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    UN16AG             UN16AH              UN17               UN18               UN19          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     DV1A               DV1B               DV1C               DV1D               DV1E          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     DV2A               DV2B               DV2C               DV2D               DV2E          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     DV2F               HT1                HT2A               HT2B               HT2C          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HT2D               HT2E               HT2F               HT2G               HT2H          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HT2I               AF2                AF3                AF6                AF8           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     AF9                AF10               AF11               AF12               HA1           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA2                HA3                HA4                HA5                HA6           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA7                HA8A               HA8B               HA8C               HA10          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    HA13A              HA13B              HA13C              HA13D               HA14          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA15               HA16               HA18               HA19               HA20          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA22               HA23               HA24               HA25               HA26          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA27               HA28               HA29               HA30               HA31          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     HA32               HA33               HA34               HA35               HA36          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     TA1                TA2                TA3                TA4                TA5           
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     TA6                TA7                TA8A               TA8B               TA8D          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     TA8X              TA8NR               TA9                TA10               TA11          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
    TA12A              TA12B              TA12C              TA12X              TA12NR         
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     TA13               TA14               TA15               TA16               TA17          
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
     LS1                LS2                LS3                LS4                 HH4        
 Length:5470        Length:5470        Length:5470        Length:5470        Min.   : 100.0  
 Class :character   Class :character   Class :character   Class :character   1st Qu.: 500.0  
     HH6                HH7                 WDOI          WAGE                WDOB     
 Length:5470        Length:5470        Min.   :2113   Length:5470        Min.   :1515  
 Class :character   Class :character   1st Qu.:2114   Class :character   1st Qu.:1679  
      WDOM          WAGEM           WDOBFC         WDOBLC       MSTATUS               CEB        
 Min.   :1628   Min.   : 5.00   Min.   :1705   Min.   :1718   Length:5470        Min.   : 0.000  
 1st Qu.:1878   1st Qu.:16.00   1st Qu.:1899   1st Qu.:1991   Class :character   1st Qu.: 0.000  
     CSURV           CDEAD          BH3_first          BH4D_first         BH4M_first       
 Min.   : 0.00   Min.   :0.00000   Length:5470        Length:5470        Length:5470       
 1st Qu.: 0.00   1st Qu.:0.00000   Class :character   Class :character   Class :character  
  BH4Y_first         BH6_first           BH3_last          BH4D_last          BH4M_last        
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
  BH4Y_last           BH6_last           welevel1           welevel2          insurance        
 Length:5470        Length:5470        Length:5470        Length:5470        Length:5470       
 Class :character   Class :character   Class :character   Class :character   Class :character  
  disability            HH7b               HH7c              WB17b              wmweight     
 Length:5470        Length:5470        Length:5470        Length:5470        Min.   :0.1188  
 Class :character   Class :character   Class :character   Class :character   1st Qu.:0.4474  
     wscore          windex5            windex10            wscoreu       windex5u        
 Min.   :-1.9615   Length:5470        Length:5470        Min.   : NA    Length:5470       
 1st Qu.:-1.0231   Class :character   Class :character   1st Qu.: NA    Class :character  
  windex10u            wscorer           windex5r          windex10r           ListCat         
 Length:5470        Min.   :-2.03922   Length:5470        Length:5470        Length:5470       
 Class :character   1st Qu.:-0.74663   Class :character   Class :character   Class :character  
      PSU          dstratum           stratum         
 Min.   :  1.0   Length:5470        Length:5470       
 1st Qu.: 97.0   Class :character   Class :character  
 [ reached getOption("max.print") -- omitted 5 rows ]
> # Define the mapping of each ethnicity to its group
> ethnicity_mapping <- list(
+   "Brahman or Chhetri" = c("Brahman - Hill", "Chhetree", "Thakuri", "Sanyasi/Dashnami", "Brahman - Tarai", "Rajput", "Kayastha"),
+   "Tarai or Madhesi Other Castes" = c("Teli", "Terai Others", "Rajbansi", "Gangai", "Yadav", "Bantaba", "Jhangad/Dhagar", "Bantar/Sardar", 
+                                       "Kewat", "Kahar", "Musahar", "Hajam/Thakur", "Koiri/Kushwaha", "Sonar", "Bangali", "Dhimal", "Danuwar", 
+                                       "Tajpuriya", "Kurmi", "Dhanuk", "Meche", "Koche", "Khawas", "Mallaha", "Kori", "Marwadi", "Kalwar", 
+                                       "Tatma/Tatwa", "Sarbaria", "Mali", "Dhobi", "Amat", "Baraee", "Dom", "Gaderi/Bhedhar", "Sudhi", "Lohar", 
+                                       "Kumhar", "Kanu", "Kathbaniyan", "Nuniya", "Dev", "Khatwe", "Kamar", "Badhaee", "Bin", "Rajbhar", 
+                                       "Lodh", "Chidimar"),
+   "Dalits" = c("Sarki", "Damai/Dholi", "Dalit Others", "Kami", "Chamar/Harijan/Ram", "Dusadh/Pasawan/Pasi", "Badi"),
+   "Newar" = c("Newar"),
+   "Janajati" = c("Gharti/Bhujel", "Limbu", "Tamang", "Gurung", "Rai", "Kulung", "Sherpa", "Magar", "Majhi", "Lepcha", "Aathpariya", 
+                  "Chamling", "Yakkha", "Hayu", "Jirel", "Chepang/Praja", "Brahmu/Baramo", "Dura", "Thakali", "Kisan", "Chhantyal/Chhantel", 
+                  "Bote", "Darai", "Byasi/Sanka", "Mewahang Bala", "Kusunda", "Raji", "Sunuwar", "Ghale", "Pahari", "Natuwa", "Thami", 
+                  "Raute", "Gurung"),
+   "Muslim" = c("Musalman"),
+   "Other" = c("Others")
+ )
> # Function to map ethnicities to groups, including handling NAs
> map_ethnicity <- function(ethnicity) {
+   if (is.na(ethnicity)) {
+     return("Missing")
+   }
+   for (group in names(ethnicity_mapping)) {
+     if (ethnicity %in% ethnicity_mapping[[group]]) {
+       return(group)
+     }
+   }
+   return("Other")  # Default to "Other" if no match is found
+ }
> # Apply the mapping to create a new variable
> data_hh <- data_hh %>%
+   mutate(EthnicityGroup = sapply(HC2, map_ethnicity))
> #Recode HHAGE into HHAGEx (4 groups)
> data_hh <- data_hh %>%
+   mutate(
+     HHAGEx = case_when(
+       HHAGE >= 15 & HHAGE <= 19 ~ 1,
+       HHAGE >= 20 & HHAGE <= 24 ~ 2,
+       HHAGE >= 25 & HHAGE <= 49 ~ 3,
+       HHAGE >= 50 ~ 4
+     )
+   )
> # Convert HHAGEx to a factor with appropriate labels
> data_hh$HHAGEx <- factor(data_hh$HHAGEx, levels = c(1, 2, 3, 4), labels = c("15-19", "20-24", "25-49", "50 plus"))
> # Check the summary to ensure the recoding worked
> summary(data_hh$HHAGEx)
  15-19   20-24   25-49 50 plus    NA's 
     76     512    6548    5519     145 
> # Convert "NO RESPONSE" to NA for the HC15 column
> data_hh <- data_hh %>%
+   mutate(HC15 = na_if(toupper(str_trim(gsub("[^[:print:]]", "", HC15))), "NO RESPONSE"))
> # Remove rows with NA values in HC15
> cleaned_data_hh <- subset(data_hh, !is.na(HC15))
> # Verify the unique values in HC15 after cleaning
> unique(cleaned_data_hh$HC15)
[1] "YES" "NO" 
> # Select relevant variables from the household dataset
> selected_data_hh <- cleaned_data_hh %>%
+   select(HH1, HH2, HH6, HH7, HH49, stratum, windex5r, HH51, HH52, HC1A, EthnicityGroup, HC15, helevel1, hhweight, HHAGEx, HHSEX, HHAGE)
> # Select relevant variables from the women's dataset
> selected_data_wm <- updated_data %>%
+   select(HH1, HH2, UN16AA, UN16AB, UN16AC, UN16AD, UN16AE, UN16AF, UN16AG, UN16AH, WAGE, WM17, CM4, MSTATUS, welevel1, wmweight, WB4)
> # Merge the datasets on HH1 and HH2
> merged_data_new <- merge(selected_data_hh, selected_data_wm, by = c("HH1", "HH2"))
> View(merged_data_new)
> #Table for the number of women following practices in different regions
> xtabs(~UN16AA + HH7, data=merged_data_new)
      HH7
UN16AA GANDAKI PROVINCE KARNALI PROVINCE PROVINCE NO. 1 PROVINCE NO. 2 PROVINCE NO. 3
   NO               625              617            826            812            743
   YES                5               74              7              5              2
      HH7
UN16AA PROVINCE NO. 5 SUDOORPASCHIM PROVINCE
   NO             980                    578
   YES              9                    182
> # Combine low count categories for demonstration
> merged_data_new$HC1A_combined <- with(merged_data_new, ifelse(HC1A %in% c("JAIN", "NO RELIGION", "OTHERS", "PRAKRITI", "BON", "KIRAT"), "OTHER", HC1A))
> # Create a new grouped variable for CM4
> merged_data_new$CM4_grouped <- ifelse(merged_data_new$CM4 >= 3, "More than 2", as.character(merged_data_new$CM4))
> # Convert the new variable to a factor
> merged_data_new$CM4_grouped <- factor(merged_data_new$CM4_grouped, levels = c("0", "1", "2", "More than 2"))
> #Group MSTATUS into two groups
> merged_data_new$MSTATUS_grouped <- ifelse(merged_data_new$MSTATUS %in% c("Currently married/in union", "Formerly married/in union"), "Ever Married", "Never Married")
> # Convert the new variable to a factor
> merged_data_new$MSTATUS_grouped <- factor(merged_data_new$MSTATUS_grouped, levels = c("Ever Married", "Never Married"))
> # Create a new variable HH51_grouped in the dataset
> merged_data_new$HH51_grouped <- ifelse(merged_data_new$HH51 > 2, "more than 3", as.character(merged_data_new$HH51))
> # Convert to a factor with meaningful levels
> merged_data_new$HH51_grouped <- factor(merged_data_new$HH51_grouped, levels = c("0", "1", "2", "more than 3"))
> # Check the distribution of the new variable
> table(merged_data_new$HH51_grouped)

          0           1           2 more than 3 
       2761        1940         619         145 
> # Create a new variable HH51_grouped in the dataset
> merged_data_new$HH52_grouped <- ifelse(merged_data_new$HH52 > 3, "more than 4", as.character(merged_data_new$HH52))
> # Convert to a factor with meaningful levels
> merged_data_new$HH52_grouped <- factor(merged_data_new$HH52_grouped, levels = c("0", "1", "2", "3", "more than 4"))
> # Check the distribution of the new variable
> table(merged_data_new$HH52_grouped)

          0           1           2           3 more than 4 
       1429        1530        1250         781         475 
> # Convert character variables to factors
> merged_data_new <- merged_data_new %>%
+   mutate(
+     HH6 = as.factor(HH6),
+     HH7 = as.factor(HH7),
+     stratum = as.factor(stratum),
+     windex5r = as.factor(windex5r),
+     HC1A = as.factor(HC1A),
+     EthnicityGroup = as.factor(EthnicityGroup),
+     HC15 = as.factor(HC15),
+     helevel1 = as.factor(helevel1),
+     HHSEX = as.factor(HHSEX),
+     UN16AA = as.factor(UN16AA),
+     UN16AB = as.factor(UN16AB),
+     UN16AC = as.factor(UN16AC),
+     UN16AD = as.factor(UN16AD),
+     UN16AE = as.factor(UN16AE),
+     UN16AF = as.factor(UN16AF),
+     UN16AG = as.factor(UN16AG),
+     UN16AH = as.factor(UN16AH),
+     WAGE = as.factor(WAGE),
+     WM17 = as.factor(WM17),
+     welevel1 = as.factor(welevel1),
+     HC1A_combined = as.factor(HC1A_combined)
+   )
> # Verify the conversion
> str(merged_data_new)
'data.frame':	5465 obs. of  37 variables:
 $ HH1            : num  1 1 1 1 1 1 1 1 1 1 ...
 $ HH2            : num  11 12 14 14 16 16 17 18 19 20 ...
 $ HH6            : Factor w/ 1 level "RURAL": 1 1 1 1 1 1 1 1 1 1 ...
 $ HH7            : Factor w/ 7 levels "GANDAKI PROVINCE",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ HH49           : num  1 1 2 2 2 2 1 1 1 1 ...
 $ stratum        : Factor w/ 7 levels "Bagmati province Rural",..: 4 4 4 4 4 4 4 4 4 4 ...
 $ windex5r       : Factor w/ 5 levels "Fourth","Middle",..: 5 5 3 3 3 3 3 5 3 5 ...
 $ HH51           : num  1 2 0 0 1 1 0 0 0 0 ...
 $ HH52           : num  0 4 4 4 1 1 0 1 0 0 ...
 $ HC1A           : Factor w/ 10 levels "BON","BUDDHIST",..: 7 7 4 4 4 4 4 4 7 4 ...
 $ EthnicityGroup : Factor w/ 7 levels "Brahman or Chhetri",..: 3 3 1 1 3 3 2 2 3 3 ...
 $ HC15           : Factor w/ 2 levels "NO","YES": 2 2 2 2 2 2 2 2 2 1 ...
 $ helevel1       : Factor w/ 4 levels "Basic (Gr 1-8)",..: 4 1 4 4 4 4 3 3 1 3 ...
 $ hhweight       : num  0.503 0.503 1.318 1.318 1.318 ...
 $ HHAGEx         : Factor w/ 4 levels "15-19","20-24",..: 4 3 3 3 4 4 3 4 3 4 ...
 $ HHSEX          : Factor w/ 2 levels "Female","Male": 2 2 2 2 2 2 2 2 2 2 ...
 $ HHAGE          : num  73 37 38 38 56 56 48 86 30 78 ...
 $ UN16AA         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AB         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AC         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AD         : Factor w/ 2 levels "NO","YES": 1 1 2 2 1 1 1 1 1 1 ...
 $ UN16AE         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AF         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AG         : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...
 $ UN16AH         : Factor w/ 2 levels "NO","YES": 1 2 2 2 2 2 2 2 2 2 ...
 $ WAGE           : Factor w/ 7 levels "15-19","20-24",..: 4 5 5 1 2 4 7 5 2 2 ...
 $ WM17           : Factor w/ 1 level "COMPLETED": 1 1 1 1 1 1 1 1 1 1 ...
 $ CM4            : num  0 2 3 NA 1 NA NA 1 NA NA ...
 $ MSTATUS        : chr  "Currently married/in union" "Currently married/in union" "Currently married/in union" "Never married/in union" ...
 $ welevel1       : Factor w/ 4 levels "Basic (Gr 1-8)",..: 4 3 4 4 4 4 3 2 1 4 ...
 $ wmweight       : num  0.509 0.509 1.333 1.333 1.333 ...
 $ WB4            : num  31 37 38 16 24 30 45 37 23 20 ...
 $ HC1A_combined  : Factor w/ 5 levels "BUDDHIST","CHRISTIAN",..: 5 5 3 3 3 3 3 3 5 3 ...
 $ CM4_grouped    : Factor w/ 4 levels "0","1","2","More than 2": 1 3 4 NA 2 NA NA 2 NA NA ...
 $ MSTATUS_grouped: Factor w/ 2 levels "Ever Married",..: 1 1 1 2 1 1 1 1 1 2 ...
 $ HH51_grouped   : Factor w/ 4 levels "0","1","2","more than 3": 2 3 1 1 2 2 1 1 1 1 ...
 $ HH52_grouped   : Factor w/ 5 levels "0","1","2","3",..: 1 5 5 5 2 2 1 2 1 1 ...
> #If you want to save the document, run the following by choosing the directory
> write.csv(merged_data_new, file = "/Users/nasib/Desktop/Nepal MICS/merged_data_with_NAs_2019.csv")
> ####################################Creating a frequency distribution (summary) table on unweighted data
> # Select the desired variables including the new summary index
> d <- merged_data_new %>% 
+   select(stratum, windex5r, HH51_grouped, HH52_grouped, EthnicityGroup, HC1A_combined, HC15, helevel1, HHAGEx, HHSEX, WAGE, welevel1, MSTATUS_grouped, UN16AA, UN16AB, UN16AC, UN16AD, UN16AE, UN16AF, UN16AG, UN16AH)
> # Example variable labels
> variable_labels <- list(
+   stratum = "Region",
+   windex5r = "Rural Wealth Index Quintile",
+   HH51_grouped = "Number of Children Under Age 5",
+   HH52_grouped = "Number of Children Age 5-17",
+   EthnicityGroup = "Ethnicity of Household Head",
+   MSTATUS_grouped = "Marital Status",
+   HC1A_combined = "Religion of Household Head",
+   HC15 = "Owns Agricultural Land",
+   helevel1 = "Education Level of Household Head",
+   HHAGEx = "Age of Household Head",
+   HHSEX = "Sex of Household Head",
+   WAGE = "Age Range of Women",
+   welevel1 = "Education of Women",
+   UN16AA = "Staying in a chaupadi/chhapro",
+   UN16AB = "Staying in a separate room ",
+   UN16AC = "Staying in the cowshed",
+   UN16AD = "Eating in a separate place",
+   UN16AE = "Bathing in a separate place",
+   UN16AF = "Staying away from school or work",
+   UN16AG = "Staying away from social gatherings",
+   UN16AH = "Staying away from religious work "
+ )
> # Create the summary table with custom labels
> summary_table <- tbl_summary(
+   d,
+   label = variable_labels
+ )
> # Display the summary table
> summary_table
> #Save it 
> summary_gt <- as_gt(summary_table)
> gtsave(summary_gt, filename = "summary_table1.png")
file:////var/folders/l1/wjxtm1y94g94hrtsqs46x1dh0000gn/T//Rtmpa8qWsp/filef6926ba8f0a.html screenshot completed
> ##########################################
> #convert Yes and NO to 1 and 0 in the practices columns
> merged_data_new <- merged_data_new %>%
+   mutate(across(c(UN16AA, UN16AB, UN16AC, UN16AD, UN16AE, UN16AF, UN16AG, UN16AH), ~ ifelse(. == "YES", 1, ifelse(. == "NO", 0, NA))))
> # Renaming levels of the factor
> # Step 1: Trim whitespace from the levels
> merged_data_new$helevel1 <- trimws(merged_data_new$helevel1)
> merged_data_new$welevel1 <- trimws(merged_data_new$welevel1)
> # Step 2: Convert factor levels with the cleaned data
> merged_data_new$helevel1 <- factor(merged_data_new$helevel1, 
+                                    levels = c("Basic (Gr 1-8)", "Higher", "None", "Secondary (Gr 9-12)") ,
+                                    labels = c("Basic", "Higher", "None", "Secondary"))
> merged_data_new$welevel1 <- factor(merged_data_new$welevel1, 
+                                    levels = c("Basic (Gr 1-8)", "Higher", "None", "Secondary (Gr 9-12)") ,
+                                    labels = c("Basic", "Higher", "None", "Secondary"))
> merged_data_new$HHAGEx <- factor(merged_data_new$HHAGEx, 
+                                    levels = c("15-19", "20-24","25-49", "50 plus" ),
+                                    labels = c("15 to 19", "20 to 24","25 to 49", "50 plus"   ))
> merged_data_new$WAGE <- factor(merged_data_new$WAGE, 
+                                  levels = c("15-19", "20-24", "25-29", "30-34", "35-39",  "40-44", "45-49" ),
+                                  labels = c("15 to 19", "20 to 24", "25 to 29","30 to 34", "35 to 39", "40 to 44",  "45 to 49" ))
> # Create survey design objects for each level
> hh_design <- svydesign(id = ~HH1, weights = ~hhweight,strata = ~stratum, data = merged_data_new)
> wm_design <- svydesign(id = ~HH1, weights = ~wmweight,strata = ~stratum, data = merged_data_new)
> summary(hh_design)
Stratified 1 - level Cluster Sampling design (with replacement)
With (222) clusters.
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)
Probabilities:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.4934  1.0633  1.5139  1.8031  2.2685  8.5346 
Stratum Sizes: 
           Bagmati province Rural Gandaki province Rural Karnali province Rural Province 1 Rural
obs                           745                    630                    691              833
design.PSU                     33                     30                     28               36
actual.PSU                     33                     30                     28               36
           Province 2 Rural Province 5 Rural Sudoorpaschim province Rural
obs                     817              989                          760
design.PSU               31               36                           28
actual.PSU               31               36                           28
Data variables:
 [1] "HH1"             "HH2"             "HH6"             "HH7"             "HH49"           
 [6] "stratum"         "windex5r"        "HH51"            "HH52"            "HC1A"           
[11] "EthnicityGroup"  "HC15"            "helevel1"        "hhweight"        "HHAGEx"         
[16] "HHSEX"           "HHAGE"           "UN16AA"          "UN16AB"          "UN16AC"         
[21] "UN16AD"          "UN16AE"          "UN16AF"          "UN16AG"          "UN16AH"         
[26] "WAGE"            "WM17"            "CM4"             "MSTATUS"         "welevel1"       
[31] "wmweight"        "WB4"             "HC1A_combined"   "CM4_grouped"     "MSTATUS_grouped"
[36] "HH51_grouped"    "HH52_grouped"   
> svymean(~WB4, hh_design) #mean age of women just to check the difference
      mean     SE
WB4 29.109 0.1547
> svymean(~WB4, wm_design)
     mean     SE
WB4 29.11 0.1548
> mean(merged_data_new$WB4) #mean age without applying weights
[1] 28.77237
> # Unweighted frequencies for household 
> if (nrow(merged_data_new) > 0) { 
+   cat('!!! UNWEIGHTED FREQUENCIES FOR HOUSEHOLD !!!\n')
+   unweighted_freq <- lapply(merged_data_new[c("stratum")], table)
+   print(unweighted_freq)
+ } else {
+   cat('No rows match the filtering criteria.\n')
+ }
!!! UNWEIGHTED FREQUENCIES FOR HOUSEHOLD !!!
$stratum

      Bagmati province Rural       Gandaki province Rural       Karnali province Rural 
                         745                          630                          691 
            Province 1 Rural             Province 2 Rural             Province 5 Rural 
                         833                          817                          989 
Sudoorpaschim province Rural 
                         760 

> # Weighted frequencies for household
> cat('!!! WEIGHTED FREQUENCIES FOR HOUSEHOLD !!!\n')
!!! WEIGHTED FREQUENCIES FOR HOUSEHOLD !!!
> weighted_freq <- svytable(~stratum, hh_design)
> print(weighted_freq)
stratum
      Bagmati province Rural       Gandaki province Rural       Karnali province Rural 
                    563.5017                     344.0732                     312.5547 
            Province 1 Rural             Province 2 Rural             Province 5 Rural 
                    763.0279                     601.4027                     955.3646 
Sudoorpaschim province Rural 
                    439.6831 
> ############################## Change the Variable names (labels) names
> attr(merged_data_new[["stratum"]], "label") <- "Region"
> attr(merged_data_new[["windex5r"]], "label") <- "Rural Wealth Index Quintile"
> attr(merged_data_new[["HH51_grouped"]], "label") <- "Number of Chilren Aged below 5"
> attr(merged_data_new[["HH52_grouped"]], "label") <- "Number of Chilren Aged 5-17"
> attr(merged_data_new[["HC1A_combined"]], "label") <- "Religion"
> attr(merged_data_new[["EthnicityGroup"]], "label") <- "Ethnicity"
> attr(merged_data_new[["HC15"]], "label") <- "Owns Agricultural Land"
> attr(merged_data_new[["helevel1"]], "label") <- "Education of Household Head"
> attr(merged_data_new[["HHAGEx"]], "label") <- "Age of Household Head"
> attr(merged_data_new[["HHSEX"]], "label") <- "Sex of Household Head"
> attr(merged_data_new[["UN16AA"]], "label") <- "Staying in a chaupadi/chhapro"
> attr(merged_data_new[["UN16AB"]], "label") <- "Staying in a separate room "
> attr(merged_data_new[["UN16AC"]], "label") <- "Staying in the cowshed"
> attr(merged_data_new[["UN16AD"]], "label") <- "Eating in a separate place"
> attr(merged_data_new[["UN16AE"]], "label") <- "Bathing in a separate place"
> attr(merged_data_new[["UN16AF"]], "label") <- "Staying away from school or work"
> attr(merged_data_new[["UN16AG"]], "label") <- "Staying away from social gatherings"
> attr(merged_data_new[["UN16AH"]], "label") <- "Staying away from religious work "
> attr(merged_data_new[["WAGE"]], "label") <- "Age of Women "
> attr(merged_data_new[["CM4"]], "label") <- "Number of daughters living together "
> attr(merged_data_new[["MSTATUS_grouped"]], "label") <- "Marital Status "
> attr(merged_data_new[["welevel1"]], "label") <- "Education of women"
> #1.Unweighted logistic regression
> unweighted_logit <- glm(UN16AA ~ stratum, data = merged_data_new, family = binomial)
> summary(unweighted_logit)

Call:
glm(formula = UN16AA ~ stratum, family = binomial, data = merged_data_new)

Coefficients:
                                    Estimate Std. Error z value Pr(>|z|)    
(Intercept)                          -5.9175     0.7080  -8.358  < 2e-16 ***
stratumGandaki province Rural         1.0892     0.8384   1.299    0.194    
stratumKarnali province Rural         3.7967     0.7186   5.284 1.27e-07 ***
stratumProvince 1 Rural               1.1469     0.8033   1.428    0.153    
stratumProvince 2 Rural               0.8275     0.8381   0.987    0.324    
stratumProvince 5 Rural               1.2272     0.7832   1.567    0.117    
stratumSudoorpaschim province Rural   4.7620     0.7131   6.678 2.42e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2232.6  on 5464  degrees of freedom
Residual deviance: 1637.4  on 5458  degrees of freedom
AIC: 1651.4

Number of Fisher Scoring iterations: 8

> # Weighted logistic regression
> weighted_logit <- svyglm(UN16AA ~ stratum, design = hh_design, family = quasibinomial)
> summary(weighted_logit)

Call:
svyglm(formula = UN16AA ~ stratum, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)                          -6.6020     0.7266  -9.086  < 2e-16 ***
stratumGandaki province Rural         1.4947     0.9117   1.640   0.1026    
stratumKarnali province Rural         4.4788     0.8348   5.365 2.14e-07 ***
stratumProvince 1 Rural               1.5600     0.8454   1.845   0.0664 .  
stratumProvince 2 Rural               1.4937     0.8759   1.705   0.0896 .  
stratumProvince 5 Rural               1.9630     0.8230   2.385   0.0180 *  
stratumSudoorpaschim province Rural   5.4450     0.7998   6.808 1.03e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 9

> #to check the frequency 
> xtabs(~UN16AA + stratum, data=merged_data_new) #for unweighted
      stratum
UN16AA Bagmati province Rural Gandaki province Rural Karnali province Rural Province 1 Rural
     0                    743                    625                    617              826
     1                      2                      5                     74                7
      stratum
UN16AA Province 2 Rural Province 5 Rural Sudoorpaschim province Rural
     0              812              980                          578
     1                5                9                          182
> svytable(~UN16AA + stratum, hh_design) #for weighted
      stratum
UN16AA Bagmati province Rural Gandaki province Rural Karnali province Rural Province 1 Rural
     0            562.7376731            342.0032093            279.1562021      758.1296442
     1              0.7639866              2.0699823             33.3984878        4.8982521
      stratum
UN16AA Province 2 Rural Province 5 Rural Sudoorpaschim province Rural
     0      597.7883594      946.2173905                  334.5060946
     1        3.6143706        9.1471856                  105.1769817
> #2. 
> # Weighted logistic regression
> weighted_logit2 <- svyglm(UN16AA ~ windex5r, design = hh_design, family = quasibinomial)
> summary(weighted_logit2)

Call:
svyglm(formula = UN16AA ~ windex5r, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -5.1705     0.3961 -13.052  < 2e-16 ***
windex5rMiddle    1.2447     0.5428   2.293   0.0228 *  
windex5rPoorest   3.1256     0.4922   6.351 1.30e-09 ***
windex5rRichest   0.3886     0.5605   0.693   0.4889    
windex5rSecond    2.5177     0.4742   5.309 2.79e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 7

> #3. 
> # Weighted logistic regression
> weighted_logit3 <- svyglm(UN16AA ~ HH51_grouped, design = hh_design, family = quasibinomial)
> summary(weighted_logit3)

Call:
svyglm(formula = UN16AA ~ HH51_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)              -3.3091     0.2235 -14.805  < 2e-16 ***
HH51_grouped1             0.1086     0.2054   0.529  0.59762    
HH51_grouped2             0.7083     0.2441   2.901  0.00411 ** 
HH51_groupedmore than 3   0.5180     0.4946   1.047  0.29610    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6

> #4 
> # Weighted logistic regression
> weighted_logit4 <- svyglm(UN16AA ~ HH52_grouped, design = hh_design, family = quasibinomial)
> summary(weighted_logit4)

Call:
svyglm(formula = UN16AA ~ HH52_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                         Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -3.495851   0.250728 -13.943   <2e-16 ***
HH52_grouped1            0.003718   0.217625   0.017   0.9864    
HH52_grouped2            0.507496   0.230898   2.198   0.0290 *  
HH52_grouped3            0.565457   0.247375   2.286   0.0233 *  
HH52_groupedmore than 4  0.818614   0.336131   2.435   0.0157 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6

> #5. 
> # Weighted logistic regression
> weighted_logit5 <- svyglm(UN16AA ~ HC1A_combined, design = hh_design, family = quasibinomial)
> summary(weighted_logit5)

Call:
svyglm(formula = UN16AA ~ HC1A_combined, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -5.12737    0.60979  -8.408  6.2e-15 ***
HC1A_combinedCHRISTIAN -12.50491    0.67221 -18.603  < 2e-16 ***
HC1A_combinedHINDU       2.09981    0.64011   3.280  0.00121 ** 
HC1A_combinedISLAM       0.08391    1.21061   0.069  0.94481    
HC1A_combinedOTHER       1.58200    0.92282   1.714  0.08794 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9791836)

Number of Fisher Scoring iterations: 16

> #6. 
> # Weighted logistic regression
> weighted_logit6 <- svyglm(UN16AA ~ helevel1, design = hh_design, family = quasibinomial)
> summary(weighted_logit6)

Call:
svyglm(formula = UN16AA ~ helevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        -3.3442     0.2336 -14.318   <2e-16 ***
helevel1Higher    -14.2342     0.2549 -55.846   <2e-16 ***
helevel1None        0.3308     0.2069   1.598    0.111    
helevel1Secondary   0.1917     0.2263   0.847    0.398    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9776964)

Number of Fisher Scoring iterations: 16

> #7.  
> # Weighted logistic regression
> weighted_logit7 <- svyglm(UN16AA ~ HHAGEx, design = hh_design, family = quasibinomial)
> summary(weighted_logit7)

Call:
svyglm(formula = UN16AA ~ HHAGEx, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     -0.8502     0.6208  -1.369  0.17231    
HHAGEx20 to 24  -1.6890     0.5948  -2.840  0.00496 ** 
HHAGEx25 to 49  -2.3069     0.5728  -4.027 7.86e-05 ***
HHAGEx50 plus   -2.4906     0.6131  -4.062 6.84e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6

> #8.  
> # Weighted logistic regression
> weighted_logit8 <- svyglm(UN16AA ~ HHSEX, design = hh_design, family = quasibinomial)
> summary(weighted_logit8)

Call:
svyglm(formula = UN16AA ~ HHSEX, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -2.9487     0.2147  -13.74   <2e-16 ***
HHSEXMale    -0.3168     0.2216   -1.43    0.154    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6

> #9.  
> # Weighted logistic regression
> weighted_logit9 <- svyglm(UN16AA ~ WAGE, design = hh_design, family = quasibinomial)
> summary(weighted_logit9)

Call:
svyglm(formula = UN16AA ~ WAGE, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -3.22522    0.22602 -14.270   <2e-16 ***
WAGE20 to 24  0.06814    0.16358   0.417    0.677    
WAGE25 to 29 -0.08365    0.20732  -0.404    0.687    
WAGE30 to 34  0.26211    0.22989   1.140    0.256    
WAGE35 to 39  0.10958    0.22810   0.480    0.631    
WAGE40 to 44 -0.05972    0.18617  -0.321    0.749    
WAGE45 to 49 -0.05766    0.27555  -0.209    0.834    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6

> #10.  
> # Weighted logistic regression
> weighted_logit10 <- svyglm(UN16AA ~ CM4_grouped, design = hh_design, family = quasibinomial)
> summary(weighted_logit10)

Call:
svyglm(formula = UN16AA ~ CM4_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -3.2696     0.2187 -14.954   <2e-16 ***
CM4_grouped1             0.1519     0.1714   0.886   0.3766    
CM4_grouped2             0.3232     0.2097   1.541   0.1248    
CM4_groupedMore than 2   0.7596     0.3010   2.524   0.0124 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9497072)

Number of Fisher Scoring iterations: 6

> #11.  
> # Weighted logistic regression
> weighted_logit11 <- svyglm(UN16AA ~ MSTATUS_grouped, design = hh_design, family = quasibinomial)
> summary(weighted_logit11)

Call:
svyglm(formula = UN16AA ~ MSTATUS_grouped, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                             Estimate Std. Error t value Pr(>|t|)    
(Intercept)                   -3.1266     0.1868 -16.738   <2e-16 ***
MSTATUS_groupedNever Married  -0.2582     0.1552  -1.664   0.0976 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6

> #12.  
> # Weighted logistic regression
> weighted_logit12 <- svyglm(UN16AA ~ welevel1, design = hh_design, family = quasibinomial)
> summary(weighted_logit12)

Call:
svyglm(formula = UN16AA ~ welevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        -3.2463     0.2097 -15.482   <2e-16 ***
welevel1Higher     -1.5230     0.7589  -2.007   0.0460 *  
welevel1None        0.3932     0.1635   2.404   0.0171 *  
welevel1Secondary  -0.2100     0.2056  -1.021   0.3083    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 7

13. Call:
svyglm(formula = UN16AA ~ HC15, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -4.0413     0.4089  -9.883   <2e-16 ***
HC15YES       0.9457     0.4071   2.323   0.0211 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 6
14.Call:
svyglm(formula = UN16AA ~ EthnicityGroup, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                  -2.2125     0.2453  -9.020  < 2e-16 *** #Brahman/chetri
EthnicityGroupDalits                         -0.7339     0.3658  -2.006  0.04613 *  
EthnicityGroupJanajati                       -2.6162     0.4026  -6.499 5.84e-10 ***
EthnicityGroupMuslim                         -2.8445     1.0667  -2.667  0.00826 ** 
EthnicityGroupNewar                          -2.6924     0.9840  -2.736  0.00675 ** 
EthnicityGroupOther                          -4.1829     1.0434  -4.009 8.49e-05 ***
EthnicityGroupTarai or Madhesi Other Castes  -2.2023     0.4635  -4.752 3.75e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000183)

Number of Fisher Scoring iterations: 8

############################################################################################################
#Staying in a separate room 
1. Call:
svyglm(formula = UN16AB ~ stratum, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)                          -1.8948     0.2530  -7.490 1.91e-12 ***
stratumGandaki province Rural         0.2634     0.3829   0.688  0.49230    
stratumKarnali province Rural         1.8481     0.3408   5.423 1.61e-07 ***
stratumProvince 1 Rural              -1.3135     0.4011  -3.275  0.00124 ** 
stratumProvince 2 Rural              -2.0512     0.5099  -4.022 8.05e-05 ***
stratumProvince 5 Rural              -0.4629     0.3243  -1.427  0.15494    
stratumSudoorpaschim province Rural   2.5133     0.4274   5.881 1.60e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 6

2. Call:
svyglm(formula = UN16AB ~ windex5r, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -2.4602     0.1891 -13.009  < 2e-16 ***
windex5rMiddle    0.8722     0.2067   4.220 3.62e-05 ***
windex5rPoorest   2.0351     0.2666   7.632 7.84e-13 ***
windex5rRichest  -0.1686     0.2412  -0.699    0.485    
windex5rSecond    1.0668     0.2331   4.577 8.05e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 5

3. Call:
svyglm(formula = UN16AB ~ HH51_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -1.51499    0.09123 -16.607   <2e-16 ***
HH51_grouped1           -0.16598    0.09360  -1.773   0.0776 .  
HH51_grouped2            0.12793    0.16178   0.791   0.4300    
HH51_groupedmore than 3 -0.40706    0.36052  -1.129   0.2601    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 4

4. Call:
svyglm(formula = UN16AB ~ HH52_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -1.68149    0.13102 -12.834   <2e-16 ***
HH52_grouped1            0.01557    0.14232   0.109   0.9130    
HH52_grouped2            0.20466    0.14013   1.461   0.1456    
HH52_grouped3            0.18344    0.15429   1.189   0.2358    
HH52_groupedmore than 4  0.46750    0.21897   2.135   0.0339 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 4

5. Call:
svyglm(formula = UN16AB ~ HC1A_combined, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)            -3.83270    0.35881 -10.682  < 2e-16 ***
HC1A_combinedCHRISTIAN  0.25105    0.75514   0.332    0.740    
HC1A_combinedHINDU      2.46994    0.37386   6.607 3.15e-10 ***
HC1A_combinedISLAM     -0.08402    0.64742  -0.130    0.897    
HC1A_combinedOTHER      0.28733    0.78209   0.367    0.714    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 6

6. Call:
svyglm(formula = UN16AB ~ helevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        -1.6689     0.1203 -13.871  < 2e-16 ***
helevel1Higher      0.8003     0.2949   2.714  0.00719 ** 
helevel1None        0.0986     0.1207   0.817  0.41475    
helevel1Secondary   0.2633     0.1502   1.753  0.08108 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 4

7. Call:
svyglm(formula = UN16AB ~ HHAGEx, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
               Estimate Std. Error t value Pr(>|t|)
(Intercept)     -0.6196     0.6445  -0.961    0.337
HHAGEx20 to 24  -0.5863     0.6630  -0.884    0.378
HHAGEx25 to 49  -0.9112     0.6523  -1.397    0.164
HHAGEx50 plus   -1.0156     0.6659  -1.525    0.129

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 4

8. Call:
svyglm(formula = UN16AB ~ HHSEX, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -1.4445     0.1100 -13.138   <2e-16 ***
HHSEXMale    -0.1497     0.1178  -1.271    0.205    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 4

9. Call:
svyglm(formula = UN16AB ~ WAGE, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -1.62479    0.11131 -14.597  < 2e-16 ***
WAGE20 to 24  0.05659    0.12945   0.437  0.66248    
WAGE25 to 29 -0.14556    0.13584  -1.072  0.28517    
WAGE30 to 34  0.21810    0.13124   1.662  0.09805 .  
WAGE35 to 39 -0.08961    0.13148  -0.682  0.49626    
WAGE40 to 44  0.16133    0.11978   1.347  0.17945    
WAGE45 to 49  0.44515    0.15700   2.835  0.00503 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 4

10. Call:
svyglm(formula = UN16AB ~ CM4_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)            -1.62729    0.09950 -16.355   <2e-16 ***
CM4_grouped1            0.10211    0.09444   1.081    0.281    
CM4_grouped2            0.08265    0.12865   0.642    0.521    
CM4_groupedMore than 2  0.27135    0.19219   1.412    0.159    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9498354)

Number of Fisher Scoring iterations: 4

11. Call:
svyglm(formula = UN16AB ~ MSTATUS_grouped, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                             Estimate Std. Error t value Pr(>|t|)    
(Intercept)                  -1.52396    0.08598 -17.725   <2e-16 ***
MSTATUS_groupedNever Married -0.14939    0.10484  -1.425    0.156    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 4

12. 
Call:
svyglm(formula = UN16AB ~ welevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       -1.59772    0.11027 -14.490   <2e-16 ***
welevel1Higher     0.38631    0.23298   1.658   0.0988 .  
welevel1None       0.11776    0.12527   0.940   0.3483    
welevel1Secondary -0.03688    0.11808  -0.312   0.7551    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 4

13. Call:
svyglm(formula = UN16AB ~ HC15, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -2.9071     0.2183 -13.317  < 2e-16 ***
HC15NO RESPONSE   4.2394     1.1631   3.645 0.000336 ***
HC15YES           1.4684     0.2296   6.395    1e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 5

14. Call:
svyglm(formula = UN16AB ~ EthnicityGroup, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                  -0.3033     0.1170  -2.592 0.010228 *  
EthnicityGroupDalits                         -0.9350     0.1993  -4.691 4.90e-06 ***
EthnicityGroupJanajati                       -2.6867     0.2730  -9.842  < 2e-16 ***
EthnicityGroupMuslim                         -3.9767     0.6408  -6.206 2.88e-09 ***
EthnicityGroupNewar                          -2.2885     0.6111  -3.745 0.000233 ***
EthnicityGroupOther                          -3.2239     0.3827  -8.425 5.80e-15 ***
EthnicityGroupTarai or Madhesi Other Castes  -3.4058     0.4068  -8.372 8.15e-15 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000361)

Number of Fisher Scoring iterations: 6
#########################################################################################
#Staying in a cowshed
1. Call:
svyglm(formula = UN16AC ~ stratum, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)                          -7.5929     0.9962  -7.622 8.60e-13 ***
stratumGandaki province Rural         3.2872     1.1646   2.823  0.00522 ** 
stratumKarnali province Rural         6.5332     1.0482   6.233 2.49e-09 ***
stratumProvince 1 Rural               2.6490     1.0870   2.437  0.01565 *  
stratumProvince 2 Rural               2.2301     1.1154   1.999  0.04687 *  
stratumProvince 5 Rural               2.6508     1.1141   2.379  0.01824 *  
stratumSudoorpaschim province Rural   6.3166     1.0344   6.107 4.89e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000075)

Number of Fisher Scoring iterations: 9

2. Call:
svyglm(formula = UN16AC ~ windex5r, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -5.3338     0.4363 -12.225  < 2e-16 ***
windex5rMiddle    0.9653     0.5434   1.776   0.0771 .  
windex5rPoorest   3.8608     0.4930   7.830 2.33e-13 ***
windex5rRichest   0.3931     0.6256   0.628   0.5304    
windex5rSecond    2.5290     0.5038   5.020 1.10e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000077)

Number of Fisher Scoring iterations: 7

3. Call:
svyglm(formula = UN16AC ~ HH51_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -3.04208    0.17247 -17.639  < 2e-16 ***
HH51_grouped1            0.07812    0.18681   0.418  0.67624    
HH51_grouped2            0.54893    0.19957   2.751  0.00646 ** 
HH51_groupedmore than 3  0.08285    0.53707   0.154  0.87755    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000077)

Number of Fisher Scoring iterations: 5

4. Call:
svyglm(formula = UN16AC ~ HH52_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)              -3.4751     0.2201 -15.790  < 2e-16 ***
HH52_grouped1             0.1700     0.2277   0.747 0.456123    
HH52_grouped2             0.7133     0.2330   3.061 0.002492 ** 
HH52_grouped3             0.9443     0.2246   4.204 3.88e-05 ***
HH52_groupedmore than 4   1.0731     0.2982   3.599 0.000398 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000077)

Number of Fisher Scoring iterations: 6

5. Call:
svyglm(formula = UN16AC ~ HC1A_combined, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -4.8781     0.5123  -9.522  < 2e-16 ***
HC1A_combinedCHRISTIAN -13.7537     0.5805 -23.694  < 2e-16 ***
HC1A_combinedHINDU       2.0856     0.5350   3.898  0.00013 ***
HC1A_combinedISLAM     -13.7869     0.5923 -23.275  < 2e-16 ***
HC1A_combinedOTHER       1.3327     0.8623   1.545  0.12373    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9376755)

Number of Fisher Scoring iterations: 17

6. Call:
svyglm(formula = UN16AC ~ helevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        -3.2265     0.1919 -16.818  < 2e-16 ***
helevel1Higher      0.2133     0.5184   0.411  0.68122    
helevel1None        0.4969     0.1755   2.831  0.00508 ** 
helevel1Secondary   0.1765     0.2064   0.855  0.39355    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000077)

Number of Fisher Scoring iterations: 6

7. Call:
svyglm(formula = UN16AC ~ HHAGEx, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)     -0.4597     0.6359  -0.723 0.470575    
HHAGEx20 to 24  -2.2604     0.6478  -3.489 0.000589 ***
HHAGEx25 to 49  -2.4489     0.6320  -3.875 0.000142 ***
HHAGEx50 plus   -2.6580     0.6540  -4.064 6.79e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000077)

Number of Fisher Scoring iterations: 5

8. Call:
svyglm(formula = UN16AC ~ HHSEX, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -2.98688    0.20012 -14.925   <2e-16 ***
HHSEXMale    0.04096    0.20554   0.199    0.842    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000077)

Number of Fisher Scoring iterations: 5

9. Call:
svyglm(formula = UN16AC ~ WAGE, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -2.82523    0.18174 -15.546   <2e-16 ***
WAGE20 to 24 -0.16790    0.15952  -1.053    0.294    
WAGE25 to 29 -0.23858    0.15577  -1.532    0.127    
WAGE30 to 34 -0.04758    0.20328  -0.234    0.815    
WAGE35 to 39 -0.24673    0.20657  -1.194    0.234    
WAGE40 to 44 -0.06013    0.16549  -0.363    0.717    
WAGE45 to 49 -0.33005    0.22255  -1.483    0.140    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000077)

Number of Fisher Scoring iterations: 5

10. Call:
svyglm(formula = UN16AC ~ CM4_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -3.1373     0.1852 -16.935  < 2e-16 ***
CM4_grouped1             0.1436     0.1431   1.004  0.31676    
CM4_grouped2             0.5729     0.1744   3.285  0.00119 ** 
CM4_groupedMore than 2   0.5112     0.2436   2.098  0.03707 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9494201)

Number of Fisher Scoring iterations: 5

11. Call:
svyglm(formula = UN16AC ~ MSTATUS_grouped, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                             Estimate Std. Error t value Pr(>|t|)    
(Intercept)                  -2.95188    0.15373 -19.202   <2e-16 ***
MSTATUS_groupedNever Married -0.01799    0.14185  -0.127    0.899    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000077)

Number of Fisher Scoring iterations: 5

12. Call:
svyglm(formula = UN16AC ~ welevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       -3.18763    0.18727 -17.021  < 2e-16 ***
welevel1Higher    -0.63984    0.56748  -1.128  0.26080    
welevel1None       0.57214    0.17722   3.228  0.00144 ** 
welevel1Secondary  0.06535    0.20105   0.325  0.74549    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000077)

Number of Fisher Scoring iterations: 6

13. Call:
svyglm(formula = UN16AC ~ HC15, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -3.9464     0.3281 -12.028  < 2e-16 ***
HC15NO RESPONSE   3.4362     1.1399   3.014 0.002887 ** 
HC15YES           1.0773     0.3059   3.522 0.000523 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000077)

Number of Fisher Scoring iterations: 6

14. Call:
svyglm(formula = UN16AC ~ EthnicityGroup, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                  -1.9559     0.1964  -9.959  < 2e-16 ***
EthnicityGroupDalits                         -0.5600     0.2647  -2.115  0.03558 *  
EthnicityGroupJanajati                       -3.0973     0.4395  -7.047 2.61e-11 ***
EthnicityGroupMuslim                        -17.7011     0.3557 -49.767  < 2e-16 ***
EthnicityGroupNewar                          -2.9615     1.0273  -2.883  0.00435 ** 
EthnicityGroupOther                         -17.6725     0.2824 -62.581  < 2e-16 ***
EthnicityGroupTarai or Madhesi Other Castes  -2.6454     0.4162  -6.356 1.28e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.8742458)

Number of Fisher Scoring iterations: 18
########################################################################################################
#Eating in a separate place
1. Call:
svyglm(formula = UN16AD ~ stratum, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)                          -0.7601     0.2662  -2.855 0.004737 ** 
stratumGandaki province Rural        -0.2963     0.3888  -0.762 0.446840    
stratumKarnali province Rural         1.9589     0.4073   4.810 2.89e-06 ***
stratumProvince 1 Rural              -0.5110     0.3410  -1.498 0.135514    
stratumProvince 2 Rural              -2.3670     0.4214  -5.618 6.13e-08 ***
stratumProvince 5 Rural              -0.2068     0.3438  -0.601 0.548300    
stratumSudoorpaschim province Rural   1.8184     0.4899   3.712 0.000264 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 5

2. 
Call:
svyglm(formula = UN16AD ~ windex5r, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     -1.37142    0.15424  -8.892 2.73e-16 ***
windex5rMiddle   0.65660    0.16029   4.096 5.99e-05 ***
windex5rPoorest  1.79454    0.24046   7.463 2.18e-12 ***
windex5rRichest -0.09401    0.18056  -0.521 0.603152    
windex5rSecond   0.74852    0.19167   3.905 0.000127 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 4

3. Call:
svyglm(formula = UN16AD ~ HH51_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -0.68864    0.09057  -7.604 9.21e-13 ***
HH51_grouped1           -0.13831    0.07913  -1.748   0.0819 .  
HH51_grouped2            0.10018    0.14133   0.709   0.4792    
HH51_groupedmore than 3 -0.74290    0.31511  -2.358   0.0193 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 4

4. Call:
svyglm(formula = UN16AD ~ HH52_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)              -0.8846     0.1215  -7.282 6.43e-12 ***
HH52_grouped1             0.1109     0.1042   1.065   0.2882    
HH52_grouped2             0.3086     0.1222   2.525   0.0123 *  
HH52_grouped3             0.1330     0.1427   0.932   0.3525    
HH52_groupedmore than 4   0.3122     0.1882   1.659   0.0986 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 4

5. Call:
svyglm(formula = UN16AD ~ HC1A_combined, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -3.7302     0.3328 -11.209   <2e-16 ***
HC1A_combinedCHRISTIAN   0.8425     0.5676   1.484   0.1392    
HC1A_combinedHINDU       3.2406     0.3424   9.466   <2e-16 ***
HC1A_combinedISLAM       0.9242     0.6460   1.431   0.1540    
HC1A_combinedOTHER       1.0892     0.5356   2.034   0.0432 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 6

6. Call:
svyglm(formula = UN16AD ~ helevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       -0.80182    0.10800  -7.424 2.72e-12 ***
helevel1Higher     0.77002    0.28701   2.683  0.00787 ** 
helevel1None      -0.03519    0.10731  -0.328  0.74331    
helevel1Secondary  0.35297    0.11440   3.085  0.00230 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 4

7. Call:
svyglm(formula = UN16AD ~ HHAGEx, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
               Estimate Std. Error t value Pr(>|t|)
(Intercept)     -0.1692     0.6035  -0.280    0.779
HHAGEx20 to 24  -0.6447     0.6190  -1.041    0.299
HHAGEx25 to 49  -0.5684     0.6088  -0.934    0.352
HHAGEx50 plus   -0.5538     0.6097  -0.908    0.365

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 4

8. Call:
svyglm(formula = UN16AD ~ HHSEX, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -0.6044     0.1217  -4.966  1.4e-06 ***
HHSEXMale    -0.1708     0.1168  -1.462    0.145    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 4

9. Call:
svyglm(formula = UN16AD ~ WAGE, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -0.760903   0.110017  -6.916 5.55e-11 ***
WAGE20 to 24 -0.048071   0.095580  -0.503    0.616    
WAGE25 to 29 -0.043836   0.117671  -0.373    0.710    
WAGE30 to 34  0.125759   0.129567   0.971    0.333    
WAGE35 to 39  0.008528   0.109588   0.078    0.938    
WAGE40 to 44  0.143811   0.099346   1.448    0.149    
WAGE45 to 49  0.095444   0.149454   0.639    0.524    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 4

10. Call:
svyglm(formula = UN16AD ~ CM4_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)            -0.79820    0.10036  -7.953 1.07e-13 ***
CM4_grouped1            0.06941    0.08841   0.785    0.433    
CM4_grouped2            0.07147    0.11229   0.636    0.525    
CM4_groupedMore than 2  0.16184    0.16657   0.972    0.332    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9495091)

Number of Fisher Scoring iterations: 4

11. Call:
svyglm(formula = UN16AD ~ MSTATUS_grouped, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                             Estimate Std. Error t value Pr(>|t|)    
(Intercept)                  -0.71990    0.08577  -8.393 6.46e-15 ***
MSTATUS_groupedNever Married -0.05602    0.09483  -0.591    0.555    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 4

12. Call:
svyglm(formula = UN16AD ~ welevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       -0.81315    0.10396  -7.822 2.43e-13 ***
welevel1Higher     0.56777    0.20543   2.764  0.00622 ** 
welevel1None      -0.05735    0.09905  -0.579  0.56323    
welevel1Secondary  0.23670    0.09109   2.599  0.01002 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 4

13. Call:
svyglm(formula = UN16AD ~ HC15, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -1.8250     0.1756 -10.390  < 2e-16 ***
HC15NO RESPONSE   3.1573     1.1656   2.709   0.0073 ** 
HC15YES           1.2129     0.1856   6.535 4.62e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 4

14. Call:
svyglm(formula = UN16AD ~ EthnicityGroup, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                   1.1052     0.1347   8.207 2.30e-14 ***
EthnicityGroupDalits                         -1.5629     0.1759  -8.886 2.97e-16 ***
EthnicityGroupJanajati                       -3.1076     0.2246 -13.838  < 2e-16 ***
EthnicityGroupMuslim                         -3.8263     0.5256  -7.280 6.66e-12 ***
EthnicityGroupNewar                          -2.5207     0.4687  -5.378 2.01e-07 ***
EthnicityGroupOther                          -3.7162     0.3542 -10.491  < 2e-16 ***
EthnicityGroupTarai or Madhesi Other Castes  -3.6754     0.2919 -12.592  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000138)

Number of Fisher Scoring iterations: 5

################################################################################################
Bathing in a separate place UN16AD
1. Call:
svyglm(formula = UN16AE ~ stratum, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)                          -3.8025     0.4162  -9.136  < 2e-16 ***
stratumGandaki province Rural         0.6131     0.5162   1.188    0.236    
stratumKarnali province Rural         3.3193     0.5211   6.369 1.19e-09 ***
stratumProvince 1 Rural               0.1066     0.5229   0.204    0.839    
stratumProvince 2 Rural              -0.8595     0.5431  -1.583    0.115    
stratumProvince 5 Rural               0.5999     0.5106   1.175    0.241    
stratumSudoorpaschim province Rural   4.5741     0.5491   8.330 1.07e-14 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 7

2. Call:
svyglm(formula = UN16AE ~ windex5r, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     -3.330203   0.253271 -13.149  < 2e-16 ***
windex5rMiddle   0.863843   0.283390   3.048   0.0026 ** 
windex5rPoorest  2.834370   0.340475   8.325 1.06e-14 ***
windex5rRichest  0.003586   0.286720   0.013   0.9900    
windex5rSecond   1.630390   0.294721   5.532 9.32e-08 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 6

3. Call:
svyglm(formula = UN16AE ~ HH51_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -1.95309    0.10430 -18.726  < 2e-16 ***
HH51_grouped1           -0.05456    0.11046  -0.494  0.62190    
HH51_grouped2            0.44849    0.16114   2.783  0.00587 ** 
HH51_groupedmore than 3  0.05335    0.34852   0.153  0.87849    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 4

4. 
Call:
svyglm(formula = UN16AE ~ HH52_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)              -2.2555     0.1390 -16.228  < 2e-16 ***
HH52_grouped1             0.1010     0.1665   0.606 0.544845    
HH52_grouped2             0.3911     0.1506   2.597 0.010052 *  
HH52_grouped3             0.5998     0.1734   3.460 0.000654 ***
HH52_groupedmore than 4   1.0577     0.2108   5.017 1.11e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 4

5. Call:
svyglm(formula = UN16AE ~ HC1A_combined, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -4.1218     0.5426  -7.596 9.75e-13 ***
HC1A_combinedCHRISTIAN  -0.6207     1.1742  -0.529    0.598    
HC1A_combinedHINDU       2.3837     0.5517   4.321 2.39e-05 ***
HC1A_combinedISLAM      -0.4696     0.8189  -0.573    0.567    
HC1A_combinedOTHER       1.0776     0.7520   1.433    0.153    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 7

6. Call:
svyglm(formula = UN16AE ~ helevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        -2.1382     0.1385 -15.438   <2e-16 ***
helevel1Higher      0.6088     0.3277   1.858   0.0645 .  
helevel1None        0.3492     0.1453   2.403   0.0171 *  
helevel1Secondary   0.2589     0.1640   1.578   0.1160    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 4

7. Call:
svyglm(formula = UN16AE ~ HHAGEx, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
               Estimate Std. Error t value Pr(>|t|)  
(Intercept)     -0.7617     0.6071  -1.255   0.2110  
HHAGEx20 to 24  -0.8059     0.6367  -1.266   0.2070  
HHAGEx25 to 49  -1.1466     0.6151  -1.864   0.0637 .
HHAGEx50 plus   -1.2182     0.6186  -1.969   0.0502 .
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 4

8. Call:
svyglm(formula = UN16AE ~ HHSEX, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) -1.93611    0.14231  -13.61   <2e-16 ***
HHSEXMale    0.02255    0.16056    0.14    0.888    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 4

9. Call:
svyglm(formula = UN16AE ~ WAGE, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -1.84669    0.12354 -14.949   <2e-16 ***
WAGE20 to 24 -0.10544    0.12019  -0.877   0.3813    
WAGE25 to 29 -0.24588    0.14639  -1.680   0.0945 .  
WAGE30 to 34  0.02941    0.14671   0.200   0.8413    
WAGE35 to 39 -0.14744    0.12440  -1.185   0.2373    
WAGE40 to 44  0.03776    0.12666   0.298   0.7659    
WAGE45 to 49 -0.13941    0.16789  -0.830   0.4073    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 4

10. Call:
svyglm(formula = UN16AE ~ CM4_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -2.0289     0.1052 -19.285  < 2e-16 ***
CM4_grouped1             0.1080     0.1018   1.060  0.29013    
CM4_grouped2             0.2323     0.1384   1.678  0.09474 .  
CM4_groupedMore than 2   0.6224     0.2019   3.083  0.00232 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9497624)

Number of Fisher Scoring iterations: 4

11. Call:
svyglm(formula = UN16AE ~ MSTATUS_grouped, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                              Estimate Std. Error t value Pr(>|t|)    
(Intercept)                  -1.919516   0.092483 -20.755   <2e-16 ***
MSTATUS_groupedNever Married  0.001957   0.103706   0.019    0.985    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 4

12. Call:
svyglm(formula = UN16AE ~ welevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
(Intercept)       -2.043622   0.114733 -17.812  < 2e-16 ***
welevel1Higher    -0.194511   0.389328  -0.500  0.61787    
welevel1None       0.361375   0.130214   2.775  0.00601 ** 
welevel1Secondary -0.008141   0.141044  -0.058  0.95403    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 4

13. Call:
svyglm(formula = UN16AE ~ HC15, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -3.0073     0.2055 -14.633  < 2e-16 ***
HC15NO RESPONSE   3.4929     1.0156   3.439 0.000702 ***
HC15YES           1.1878     0.2188   5.429 1.54e-07 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 5

14. Call:
svyglm(formula = UN16AE ~ EthnicityGroup, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                  -0.7553     0.1396  -5.412 1.70e-07 ***
EthnicityGroupDalits                         -0.8558     0.2394  -3.575 0.000436 ***
EthnicityGroupJanajati                       -2.9839     0.3311  -9.013  < 2e-16 ***
EthnicityGroupMuslim                         -3.2765     0.5686  -5.762 2.95e-08 ***
EthnicityGroupNewar                          -3.1948     0.7195  -4.440 1.45e-05 ***
EthnicityGroupOther                          -3.1300     0.4928  -6.351 1.31e-09 ***
EthnicityGroupTarai or Madhesi Other Castes  -2.9793     0.3856  -7.726 4.56e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 1.000079)

Number of Fisher Scoring iterations: 6
##############################################################################################
#Staying away from school or work UN16AF
1. Call:
svyglm(formula = UN16AF ~ stratum, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)                          -6.6018     0.5808 -11.367  < 2e-16 ***
stratumGandaki province Rural         1.6475     0.7504   2.196   0.0292 *  
stratumKarnali province Rural         3.4199     0.7106   4.813 2.85e-06 ***
stratumProvince 1 Rural               1.8907     0.7365   2.567   0.0109 *  
stratumProvince 2 Rural               1.5428     0.7442   2.073   0.0394 *  
stratumProvince 5 Rural               1.3008     0.7634   1.704   0.0899 .  
stratumSudoorpaschim province Rural   4.9581     0.6470   7.663 6.70e-13 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9998084)

Number of Fisher Scoring iterations: 9

2. Call:
svyglm(formula = UN16AF ~ windex5r, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -5.1252     0.3706 -13.830  < 2e-16 ***
windex5rMiddle    0.3963     0.4660   0.850    0.396    
windex5rPoorest   2.5664     0.4752   5.401 1.78e-07 ***
windex5rRichest   0.7484     0.4838   1.547    0.123    
windex5rSecond    1.8753     0.4688   4.001 8.74e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9998084)

Number of Fisher Scoring iterations: 7

3. Call:
svyglm(formula = UN16AF ~ HH51_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)              -3.7921     0.1881 -20.156   <2e-16 ***
HH51_grouped1             0.3538     0.2515   1.407   0.1610    
HH51_grouped2             0.5171     0.2921   1.771   0.0781 .  
HH51_groupedmore than 3  -0.5158     0.6308  -0.818   0.4144    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9998084)

Number of Fisher Scoring iterations: 6

4. Call:
svyglm(formula = UN16AF ~ HH52_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
(Intercept)              -3.8262     0.2211 -17.306   <2e-16 ***
HH52_grouped1             0.0292     0.2308   0.127   0.8994    
HH52_grouped2             0.2487     0.2719   0.915   0.3614    
HH52_grouped3             0.2889     0.3330   0.867   0.3867    
HH52_groupedmore than 4   0.7241     0.3324   2.179   0.0305 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9998084)

Number of Fisher Scoring iterations: 6

5. Call:
svyglm(formula = UN16AF ~ HC1A_combined, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -5.0017     0.5441  -9.192  < 2e-16 ***
HC1A_combinedCHRISTIAN -13.6300     0.6131 -22.230  < 2e-16 ***
HC1A_combinedHINDU       1.5018     0.5676   2.646  0.00877 ** 
HC1A_combinedISLAM     -13.6619     0.6223 -21.955  < 2e-16 ***
HC1A_combinedOTHER       1.6871     0.8058   2.094  0.03749 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9378745)

Number of Fisher Scoring iterations: 17

6. Call:
svyglm(formula = UN16AF ~ helevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)       -3.73325    0.21095 -17.698   <2e-16 ***
helevel1Higher     0.12683    0.50046   0.253    0.800    
helevel1None       0.17952    0.21502   0.835    0.405    
helevel1Secondary  0.09775    0.28351   0.345    0.731    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9998084)

Number of Fisher Scoring iterations: 6

7. Call:
svyglm(formula = UN16AF ~ HHAGEx, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
               Estimate Std. Error t value Pr(>|t|)   
(Intercept)     -2.0527     0.7328  -2.801  0.00557 **
HHAGEx20 to 24  -0.9549     0.9231  -1.034  0.30212   
HHAGEx25 to 49  -1.5817     0.6949  -2.276  0.02384 * 
HHAGEx50 plus   -1.6737     0.7435  -2.251  0.02541 * 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9998084)

Number of Fisher Scoring iterations: 6

8. Call:
svyglm(formula = UN16AF ~ HHSEX, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -3.5196     0.2344 -15.015   <2e-16 ***
HHSEXMale    -0.1539     0.2105  -0.731    0.465    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9998084)

Number of Fisher Scoring iterations: 6

9. Call:
svyglm(formula = UN16AF ~ WAGE, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -3.87237    0.27315 -14.177   <2e-16 ***
WAGE20 to 24  0.35228    0.21486   1.640   0.1026    
WAGE25 to 29  0.09600    0.25887   0.371   0.7111    
WAGE30 to 34  0.63592    0.28892   2.201   0.0288 *  
WAGE35 to 39  0.14616    0.28095   0.520   0.6035    
WAGE40 to 44  0.21646    0.24932   0.868   0.3863    
WAGE45 to 49  0.07744    0.30004   0.258   0.7966    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9998084)

Number of Fisher Scoring iterations: 6

10. Call:
svyglm(formula = UN16AF ~ CM4_grouped, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                       Estimate Std. Error t value Pr(>|t|)    
(Intercept)             -3.5055     0.2153 -16.285   <2e-16 ***
CM4_grouped1             0.1082     0.2143   0.505    0.614    
CM4_grouped2            -0.1550     0.3151  -0.492    0.623    
CM4_groupedMore than 2  -0.1438     0.4733  -0.304    0.762    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9493968)

Number of Fisher Scoring iterations: 6

11. Call:
svyglm(formula = UN16AF ~ MSTATUS_grouped, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                             Estimate Std. Error t value Pr(>|t|)    
(Intercept)                   -3.5483     0.1703 -20.842   <2e-16 ***
MSTATUS_groupedNever Married  -0.4520     0.2490  -1.815   0.0709 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9998084)

Number of Fisher Scoring iterations: 6

12. Call:
svyglm(formula = UN16AF ~ welevel1, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)    
(Intercept)        -3.4638     0.2110 -16.415   <2e-16 ***
welevel1Higher     -0.5194     0.5113  -1.016   0.3109    
welevel1None       -0.1132     0.1735  -0.652   0.5149    
welevel1Secondary  -0.3888     0.2299  -1.691   0.0923 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9998084)

Number of Fisher Scoring iterations: 6

13. Call:
svyglm(formula = UN16AF ~ HC15, design = hh_design, family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)      -4.3346     0.4253 -10.191  < 2e-16 ***
HC15NO RESPONSE   4.8202     1.0557   4.566  8.4e-06 ***
HC15YES           0.7570     0.3914   1.934   0.0544 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9998084)

Number of Fisher Scoring iterations: 6

14. Call:
svyglm(formula = UN16AF ~ EthnicityGroup, design = hh_design, 
    family = quasibinomial)

Survey design:
svydesign(id = ~HH1, weights = ~hhweight, strata = ~stratum, 
    data = merged_data_new)

Coefficients:
                                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                                  -2.8108     0.2296 -12.240  < 2e-16 ***
EthnicityGroupDalits                         -0.4324     0.4000  -1.081 0.280966    
EthnicityGroupJanajati                       -2.2806     0.4332  -5.264 3.48e-07 ***
EthnicityGroupMuslim                        -15.8448     0.3714 -42.661  < 2e-16 ***
EthnicityGroupNewar                         -15.8510     0.3632 -43.637  < 2e-16 ***
EthnicityGroupOther                          -2.0841     0.6490  -3.212 0.001529 ** 
EthnicityGroupTarai or Madhesi Other Castes  -1.6428     0.4568  -3.597 0.000402 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for quasibinomial family taken to be 0.9481032)

Number of Fisher Scoring iterations: 17

